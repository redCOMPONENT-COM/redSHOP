function IsNumeric(e){var t="0123456789",n,r=!0;if(e.length==0)return!1;for(i=0;i<e.length&&r==1;i++)n=e.charAt(i),t.indexOf(n)==-1&&(r=!1);return r}function isString(e){var t=e.value,n=t.length,r=". -,",i;for(var s=0;s!=n;s++){aChar=t.substring(s,s+1),aChar=aChar.toUpperCase(),i=r.indexOf(aChar);if(i==-1&&(aChar<"A"||aChar>"Z"))return!1}return!0}function CheckCardNumber(form){var tmpyear;if(form.order_payment_name.value.length>0&&isString(form.order_payment_name)==0)return alert("Please do not enter Numeric value in card name."),form.order_payment_name.focus(),!1;if(form.order_payment_number.value.length==0)return alert("Please enter a Card Number."),form.order_payment_number.focus(),!1;if(IsNumeric(form.order_payment_number.value)==0)return alert("Please enter Numeric value only in card number."),form.order_payment_number.focus(),!1;tmpyear=form.order_payment_expire_year.options[form.order_payment_expire_year.selectedIndex].value,tmpmonth=form.order_payment_expire_month.options[form.order_payment_expire_month.selectedIndex].value;if(!(new CardType).isExpiryDate(tmpyear,tmpmonth))return alert("This card has already expired."),!1;card="",cardlen=form.creditcard_code.length;for(var c=0;c<cardlen;c++)form.creditcard_code[c].checked&&(card=form.creditcard_code[c].value);if(card=="")return alert("Please Select Credit Card type"),!1;var retval=eval(card+'.checkCardNumber("'+form.order_payment_number.value+'", '+tmpyear+", "+tmpmonth+");");return cardname="",retval?!isNum(form.credit_card_code.value)||trim(form.credit_card_code.value)==""||card=="amex"&&form.credit_card_code.value.length!=4||card!="amex"&&form.credit_card_code.value.length!=3?(alert("Enter vaild Security Number."),!1):!0:(alert("This card number is not valid."),!1)}function CardType(){var e,t=CardType.arguments,n=CardType.arguments.length;this.objname="object CardType";var r=n>0?t[0]:"CardObject",i=n>1?t[1]:"0,1,2,3,4,5,6,7,8,9",s=n>2?t[2]:"13,14,15,16,19";return this.setCardNumber=setCardNumber,this.setCardType=setCardType,this.setLen=setLen,this.setRules=setRules,this.setExpiryDate=setExpiryDate,this.setCardType(r),this.setLen(s),this.setRules(i),n>4&&this.setExpiryDate(t[3],t[4]),this.checkCardNumber=checkCardNumber,this.getExpiryDate=getExpiryDate,this.getCardType=getCardType,this.isCardNumber=isCardNumber,this.isExpiryDate=isExpiryDate,this.luhnCheck=luhnCheck,this}function checkCardNumber(){var e=checkCardNumber.arguments,t=checkCardNumber.arguments.length,n=t>0?e[0]:this.cardnumber,r=t>1?e[1]:this.year,i=t>2?e[2]:this.month;return this.setCardNumber(n),this.setExpiryDate(r,i),this.isCardNumber()?this.isExpiryDate()?!0:!1:!1}function getCardType(){return this.cardtype}function getExpiryDate(){return this.month+"/"+this.year}function isCardNumber(){var e=isCardNumber.arguments,t=isCardNumber.arguments.length,n=t>0?e[0]:this.cardnumber;if(!this.luhnCheck())return!1;for(var r=0;r<this.len.size;r++)if(n.toString().length==this.len[r]){for(var i=0;i<this.rules.size;i++){var s=n.substring(0,this.rules[i].toString().length);if(s==this.rules[i])return!0}return!1}return!1}function isExpiryDate(){var e=isExpiryDate.arguments,t=isExpiryDate.arguments.length;return year=t>0?e[0]:this.year,month=t>1?e[1]:this.month,isNum(year+"")?isNum(month+"")?(today=new Date,expiry=new Date(year,month),today.getTime()>expiry.getTime()?!1:!0):!1:!1}function isNum(e){e=e.toString();if(e.length==0)return!1;for(var t=0;t<e.length;t++)if(e.substring(t,t+1)<"0"||e.substring(t,t+1)>"9")return!1;return!0}function luhnCheck(){var e=luhnCheck.arguments,t=luhnCheck.arguments.length,n=t>0?e[0]:this.cardnumber;if(!isNum(n))return!1;var r=n.length,i=r&1,s=0;for(var o=0;o<r;o++){var u=parseInt(n.charAt(o));o&1^i||(u*=2,u>9&&(u-=9)),s+=u}return s%10==0?!0:!1}function makeArray(e){return this.size=e,this}function setCardNumber(e){return this.cardnumber=e,this}function setCardType(e){return this.cardtype=e,this}function setExpiryDate(e,t){return this.year=e,this.month=t,this}function setLen(e){if(e.length==0||e==null)e="13,14,15,16,19";var t=e;n=1;while(t.indexOf(",")!=-1)t=t.substring(t.indexOf(",")+1,t.length),n++;this.len=new makeArray(n),n=0;while(e.indexOf(",")!=-1){var r=e.substring(0,e.indexOf(","));this.len[n]=r,e=e.substring(e.indexOf(",")+1,e.length),n++}return this.len[n]=e,this}function setRules(e){if(e.length==0||e==null)e="0,1,2,3,4,5,6,7,8,9";var t=e;n=1;while(t.indexOf(",")!=-1)t=t.substring(t.indexOf(",")+1,t.length),n++;this.rules=new makeArray(n),n=0;while(e.indexOf(",")!=-1){var r=e.substring(0,e.indexOf(","));this.rules[n]=r,e=e.substring(e.indexOf(",")+1,e.length),n++}return this.rules[n]=e,this}var Cards=new makeArray(8);Cards[0]=new CardType("MasterCard","51,52,53,54,55","16");var MC=Cards[0],maestro=Cards[0];Cards[1]=new CardType("VisaCard","4","13,16");var VISA=Cards[1];Cards[2]=new CardType("AmExCard","34,37","15");var amex=Cards[2];Cards[3]=new CardType("DinersClubCard","30,36,38","14");var diners=Cards[3];Cards[4]=new CardType("DiscoverCard","6011","16");var DiscoverCard=Cards[4];Cards[5]=new CardType("enRouteCard","2014,2149","15");var enRouteCard=Cards[5];Cards[6]=new CardType("JCBCard","3088,3096,3112,3158,3337,3528","16");var jcb=Cards[6],LuhnCheckSum=Cards[7]=new CardType;