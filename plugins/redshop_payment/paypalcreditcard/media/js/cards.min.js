jQuery(document).ready(function(e){jQuery("#newCardform").hide(),jQuery('[id^="card-edit-"]').hide(),jQuery(document).on("click",".edit, .cancel",function(){var e=jQuery(this).attr("cardId");if(e!=0){var t=jQuery("#card-edit-"+e);t.find('[name="cardNumber"]').attr("readonly","readonly"),t.fadeToggle("slow")}else jQuery("#newCardform").fadeToggle("slow")}),jQuery(document).on("click",'[id^="save-"]',function(e){e.preventDefault(),jQuery(this).attr("disabled","disabled"),jQuery(".cancel").attr("disabled","disabled"),jQuery(".credit-card-form").css("opacity","0.3");var t=this.id.replace("save-",""),n=t==0?jQuery("#newCardform"):jQuery("#card-edit-"+t),r=t==0?"new":"update",i={option:"com_redshop",view:"account",layout:"cards",plugin:"paypalcreditcard",task:r,cardId:t,cardType:n.find('[name="cardType"]').val(),cardNumber:n.find('[name="cardNumber"]').val(),cardName:n.find('[name="cardName"]').val(),cardExpireMonth:n.find('[name="cardExpireMonth"]').val(),cardExpireYear:n.find('[name="cardExpireYear"]').val(),cardCvv:n.find('[name="cardCvv"]').val()};jQuery.ajax({url:redSHOP.RSConfig._("SITE_URL")+"?tmpl =component",type:"POST",dataType:"json",data:i}).always(function(e,s){if(s=="timeout"||s=="parsererror")jQuery(".ajax-error").html('<span class="label label-important">Server Timeout</span>');else if(typeof e=="undefined"||s=="error")jQuery(".ajax-error").html('<span class="label label-important">Application Error</span>');else if(e.messages.length>0){var o=!1;jQuery(e.messages).each(function(e,t){jQuery(".ajax-error").html(t.message),t.type_message!="success"&&(o=!0)});if(!o){if("update"==r){var u=jQuery("#card-"+t).children(),a=jQuery(u.get(0)).find("input").length>0?1:0;jQuery(u.get(a)).html(i.cardName),jQuery(u.get(a+3)).html(i.cardExpireMonth),jQuery(u.get(a+4)).html(i.cardExpireYear)}else e.cardId!=0&&(jQuery(".creditCards table").prepend(e.response),n.find('[name="cardNumber"]').val(""),n.find('[name="cardName"]').val(""),n.find('[name="cardExpireMonth"]').val(""),n.find('[name="cardExpireYear"]').val(""),n.find('[name="cardCvv"]').val(""));n.fadeToggle("slow")}}jQuery('[id^="save-"]').removeAttr("disabled","disabled"),jQuery(".cancel").removeAttr("disabled","disabled"),jQuery(".credit-card-form").css("opacity","")})}),jQuery(document).on("click",'[id^="delete-"]',function(e){e.preventDefault();var t=this.id.replace("delete-","");jQuery("#card-"+t).css("opacity","0.3");var n={option:"com_redshop",view:"account",layout:"cards",plugin:"paypalcreditcard",task:"delete",cardId:t};jQuery.ajax({url:redSHOP.RSConfig._("SITE_URL")+"?tmpl=component",type:"POST",dataType:"json",data:n}).always(function(e,n){if(n=="timeout"||n=="parsererror")jQuery(".ajax-error").html('<span class="label label-important">Server Issue/Timeout</span>');else if(typeof e=="undefined"||n=="error")jQuery(".ajax-error").html('<span class="label label-important">Application Error</span>');else if(e.messages.length>0){var r=!1;jQuery(e.messages).each(function(e,t){jQuery(".ajax-error").html(t.message),t.type_message!="success"&&(r=!0)}),r||(jQuery("#card-"+t).fadeOut("slow",function(){jQuery(this).remove()}),jQuery("#card-edit-"+t).fadeOut("slow",function(){jQuery(this).remove()}))}})}),jQuery(document).on("click","#newCardBtn",function(e){e.preventDefault(),jQuery("#newCardform").fadeToggle("slow")})});