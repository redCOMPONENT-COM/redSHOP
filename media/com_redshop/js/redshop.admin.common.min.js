"use strict";function GetXmlHttpObject(){return window.XMLHttpRequest?new XMLHttpRequest:window.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):null}function updateGLSLocation(e){var t=redSHOP.RSConfig._("SITE_URL")+"index.php?tmpl=component&option=com_redshop&view=checkout&task=updateGLSLocation";t+="&zipcode="+e,null!==document.getElementById("shipp_users_info_id")&&(t+="&users_info_id="+document.getElementById("shipp_users_info_id").value),jQuery.ajax({url:t,type:"GET"}).done(function(e){jQuery("#rs_locationdropdown").html(e),jQuery('select:not(".disableBootstrapChosen")').select2()}).fail(function(){console.warn("error")})}function number_format(e,t,n,d){function o(e,t){var n=Math.pow(10,t);return(Math.round(e*n)/n).toString()}var r,l,i=e,a=t,i=isFinite(+i)?+i:0,u=void 0===d?",":d,c=void 0===n?".":n,m=o(0<(a=isFinite(+a)?Math.abs(a):0)?i:Math.round(i),a),p=o(Math.abs(i),a),_=(m=1e3<=p?(l=(r=p.split(/\D/))[0].length%3||3,r[0]=m.slice(0,l+(i<0))+r[0].slice(l).replace(/(\d{3})/g,u+"$1"),r.join(c)):m.replace(".",c)).indexOf(c);1<=a&&-1!==_&&m.length-_-1<a?m+=new Array(a-(m.length-_-1)).join(0)+"0":1<=a&&-1===_&&(m+=c+new Array(a).join(0)+"0");return"front"==redSHOP.RSConfig._("CURRENCY_SYMBOL_POSITION")?redSHOP.RSConfig._("REDCURRENCY_SYMBOL")+"&nbsp;"+m:"behind"==redSHOP.RSConfig._("CURRENCY_SYMBOL_POSITION")?m+"&nbsp;"+redSHOP.RSConfig._("REDCURRENCY_SYMBOL"):"none"==redSHOP.RSConfig._("CURRENCY_SYMBOL_POSITION")?m:redSHOP.RSConfig._("REDCURRENCY_SYMBOL")+"&nbsp;"+m}function trim(e,t){return ltrim(rtrim(e,t),t)}function ltrim(e,t){return t=t||"\\s",e.replace(new RegExp("^["+t+"]+","g"),"")}function rtrim(e,t){return t=t||"\\s",e.replace(new RegExp("["+t+"]+$","g"),"")}function collectOfflineAttributes(e,t,n){var d,o=new Array,r=new Array,l=new Array,i=0,a=0,u="";0!=t?(d="acc_",document.getElementById("accessory_id_"+e+"_"+t+n)&&(i=parseFloat(document.getElementById("accessory_id_"+e+"_"+t+n).getAttribute("accessoryprice")),a=parseFloat(document.getElementById("accessory_id_"+e+"_"+t+n).getAttribute("accessorypricevat")))):(d="prd_",document.getElementById("main_price"+n)&&(i=parseFloat(document.getElementById("main_price"+n).value)),document.getElementById("product_vatprice"+n)&&(a=parseFloat(document.getElementById("product_vatprice"+n).value)));var c=n+d+e+"_"+t;if(document.getElementsByName("attribute_id_"+c+"[]"))for(var m=document.getElementsByName("attribute_id_"+c+"[]"),p=0;p<m.length;p++)o[p]=m[p].value;for(p=0;p<o.length;p++){var _=o[p],c=n+d+e+"_"+t+"_"+_,s=document.getElementById("property_id_"+c);if(s){for(var y=document.getElementsByName("property_id_"+c+"[]"),E=0,g=new Array,I=0;I<y.length;I++)"checkbox"==y[I].type||"radio"==y[I].type?y[I].checked&&0!=y[I].value&&(g[E++]=y[I].value):y[I].selectedIndex&&0!=y[I].options[y[I].selectedIndex].value&&(g[E++]=y[I].options[y[I].selectedIndex].value);r[p]=g.join(",,"),1==s.getAttribute("required")&&0==g.length&&(document.getElementById("att_lebl")&&(u+=document.getElementById("att_lebl").innerHTML+" "),u+=unescape(s.getAttribute("attribute_name"))+"\n");for(var B=calculateOfflineProductPrice(i,a,"property_id_"+c+"_oprand","property_id_"+c+"_proprice","property_id_"+c+"_protax",g),i=B[1],a=B[2],v=new Array,I=0;I<g.length;I++){var S=n+d+e+"_"+t+"_"+_+"_"+g[I];if(document.getElementById("subproperty_id_"+S)){for(var f=document.getElementsByName("subproperty_id_"+S+"[]"),E=0,R=new Array,O=0;O<f.length;O++)"checkbox"==f[O].type||"radio"==f[O].type?f[O].checked&&f[O].value&&(R[E++]=f[O].value):f[O].selectedIndex&&f[O].options[f[O].selectedIndex].value&&(R[E++]=f[O].options[f[O].selectedIndex].value);var T=calculateOfflineProductPrice(i,a,"subproperty_id_"+S+"_oprand","subproperty_id_"+S+"_proprice","subproperty_id_"+S+"_protax",R);i=T[1],a=T[2],v[I]=R.join("::")}}l[p]=v.join(",,")}}0!=t?(document.getElementById("acc_attribute_data"+n)&&(document.getElementById("acc_attribute_data"+n).value=o.join("##")),document.getElementById("acc_property_data"+n)&&(document.getElementById("acc_property_data"+n).value=r.join("##")),document.getElementById("acc_subproperty_data"+n)&&(document.getElementById("acc_subproperty_data"+n).value=l.join("##")),document.getElementById("accessory_price"+n)&&(document.getElementById("accessory_price"+n).value=i),document.getElementById("accessory_vatprice"+n)&&(document.getElementById("accessory_vatprice"+n).value=a)):(document.getElementById("attribute_data"+n)&&(document.getElementById("attribute_data"+n).value=o.join("##")),document.getElementById("property_data"+n)&&(document.getElementById("property_data"+n).value=r.join("##")),document.getElementById("subproperty_data"+n)&&(document.getElementById("subproperty_data"+n).value=l.join("##")),document.getElementById("tmp_product_price"+n)&&(document.getElementById("tmp_product_price"+n).value=i),document.getElementById("tmp_product_vatprice"+n)&&(document.getElementById("tmp_product_vatprice"+n).value=a)),document.getElementById("requiedAttribute"+n)&&(document.getElementById("requiedAttribute"+n).value=u)}function calculateOfflineProductPrice(e,t,n,d,o,r){for(var l=!0,i=0;i<r.length;i++){var a=r[i],u=document.getElementById(n+a).value,c=document.getElementById(d+a).value,m=document.getElementById(o+a).value;if("-"==u)e-=parseFloat(c),t-=parseFloat(m);else if("+"==u)e+=parseFloat(c),t+=parseFloat(m);else if("*"==u)e*=parseFloat(c),t*=parseFloat(m);else if("/"==u)e/=parseFloat(c),t/=parseFloat(m);else if("="==u){e=parseFloat(c),t=parseFloat(m),l=!1;break}}var p=new Array;return p[0]=l,p[1]=e,p[2]=t,p}function calculateOfflineTotalPrice(e){var t=0;if(document.getElementById(e)&&(0==(t=document.getElementById(e).value)||""==t))return!1;var n=0,d=0,o=collectOfflineAccessory(t,e);document.getElementById("accessory_vatprice"+e)&&(d=o-parseFloat(document.getElementById("accessory_vatprice"+e).value)),collectOfflineAttributes(t,0,e);var r=0;document.getElementById("tmp_product_price"+e)&&(n=parseFloat(document.getElementById("tmp_product_price"+e).value)),document.getElementById("tmp_product_vatprice"+e)&&(r=n-document.getElementById("tmp_product_vatprice"+e).value);var l=0;wprice=setOfflineWrapperComboBox(t,e),document.getElementById("wrapper_vatprice"+e)&&(l=wprice-parseFloat(document.getElementById("wrapper_vatprice"+e).value));var i;final_price_f=parseFloat(n)+parseFloat(o)+parseFloat(wprice),i=parseFloat(r)+parseFloat(d)+parseFloat(l),document.getElementById("prdprice"+e)&&(document.getElementById("prdprice"+e).innerHTML=number_format(final_price_f,redSHOP.RSConfig._("PRICE_DECIMAL"),redSHOP.RSConfig._("PRICE_SEPERATOR"),redSHOP.RSConfig._("THOUSAND_SEPERATOR"))),document.getElementById("productprice"+e)&&(document.getElementById("productprice"+e).value=final_price_f),document.getElementById("prdexclprice"+e)&&(document.getElementById("prdexclprice"+e).value=i);var a=1;document.getElementById("quantity"+e)&&""!=trim(document.getElementById("quantity"+e).value)&&!isNaN(document.getElementById("quantity"+e).value)&&(a=document.getElementById("quantity"+e).value),document.getElementById("quantity"+e).value=a,document.getElementById("prdtax"+e)&&(document.getElementById("prdtax"+e).innerHTML=number_format(final_price_f-i,redSHOP.RSConfig._("PRICE_DECIMAL"),redSHOP.RSConfig._("PRICE_SEPERATOR"),redSHOP.RSConfig._("THOUSAND_SEPERATOR"))),document.getElementById("taxprice"+e)&&(document.getElementById("taxprice"+e).value=(final_price_f-i)*a),document.getElementById("subprice"+e)&&(document.getElementById("subprice"+e).value=i*a),document.getElementById("tdtotalprd"+e)&&(document.getElementById("tdtotalprd"+e).innerHTML=number_format(a*final_price_f,redSHOP.RSConfig._("PRICE_DECIMAL"),redSHOP.RSConfig._("PRICE_SEPERATOR"),redSHOP.RSConfig._("THOUSAND_SEPERATOR"))),calculateOfflineTotal()}function setOfflineWrapperComboBox(e,t){if(0==e||""==e)return!1;var n=0,d=0,o=e+t,r=document.getElementsByName("wrapper_id_"+o+"[]");seli=0;for(var l,i=new Array,a=0;a<r.length;a++){r[a].selectedIndex&&r[a].options[r[a].selectedIndex].value&&(l=r[a].options[r[a].selectedIndex].value,document.getElementById("wprice_"+o+"_"+l)&&(n=parseFloat(document.getElementById("wprice_"+o+"_"+l).value)),document.getElementById("wprice_tax_"+o+"_"+l)&&(d=parseFloat(document.getElementById("wprice_tax_"+o+"_"+l).value)),i[seli++]=l)}return document.getElementById("wrapper_vatprice"+t)&&(document.getElementById("wrapper_vatprice"+t).value=d),document.getElementById("wrapper_data"+t)&&(document.getElementById("wrapper_data"+t).value=i.join("##")),n}function collectOfflineAccessory(e,t){if(0==e||""==e)return!1;var n=0,d=0,o=0,r=0,l=0,i=new Array,a=new Array,u=new Array,c=new Array;if(document.getElementsByName("accessory_id_"+e+t+"[]")){dcatt=document.getElementsByName("accessory_id_"+e+t+"[]");var m=dcatt.length;for(j=0;j<m;j++){var p=0,_=0,s=dcatt[j].value,y=e+"_"+s+t;acc_chk=document.getElementById("accessory_id_"+y),document.getElementById("attribute_id_"+y)&&document.getElementById("attribute_id_"+y),dcatt[j].checked&&(collectOfflineAttributes(e,i[l]=s,t),document.getElementById("accessory_price"+t)&&(p=parseFloat(document.getElementById("accessory_price"+t).value)),document.getElementById("accessory_vatprice"+t)&&(_=parseFloat(document.getElementById("accessory_vatprice"+t).value)),document.getElementById("acc_attribute_data"+t)&&(a[l]=document.getElementById("acc_attribute_data"+t).value),document.getElementById("acc_property_data"+t)&&(u[l]=document.getElementById("acc_property_data"+t).value),document.getElementById("acc_subproperty_data"+t)&&(c[l]=document.getElementById("acc_subproperty_data"+t).value),l++),o+=parseFloat(p),r+=parseFloat(_)}n+=parseFloat(o),d+=parseFloat(r),document.getElementById("accessory_data"+t)&&(document.getElementById("accessory_data"+t).value=i.join("@@")),document.getElementById("acc_attribute_data"+t)&&(document.getElementById("acc_attribute_data"+t).value=a.join("@@")),document.getElementById("acc_property_data"+t)&&(document.getElementById("acc_property_data"+t).value=u.join("@@")),document.getElementById("acc_subproperty_data"+t)&&(document.getElementById("acc_subproperty_data"+t).value=c.join("@@")),document.getElementById("accessory_price"+t)&&(document.getElementById("accessory_price"+t).value=n),document.getElementById("accessory_vatprice"+t)&&(document.getElementById("accessory_vatprice"+t).value=d)}return n}function displayProductDetailInfo(unique_id,newprice){if(xmlhttp=GetXmlHttpObject(),null!=xmlhttp){var val="",quantity=1,product_id=0,user_id=0;if(document.getElementById("user_id")&&(user_id=document.getElementById("user_id").value),document.getElementById(unique_id)&&(product_id=document.getElementById(unique_id).value),0==product_id||""==product_id)return!1;document.getElementById("quantity"+unique_id)&&""!=trim(document.getElementById("quantity"+unique_id).value)&&!isNaN(document.getElementById("quantity"+unique_id).value)&&(quantity=document.getElementById("quantity"+unique_id).value),document.getElementById("quantity"+unique_id).value=quantity;var pval="&product="+product_id,pval=pval+"&quantity="+quantity;pval=pval+"&user_id="+user_id,pval=pval+"&unique_id="+unique_id,pval=pval+"&newprice="+newprice,document.getElementById("order_subtotal")&&(pval=pval+"&ordertotal="+document.getElementById("order_subtotal").value);var url="index.php?tmpl=component&option=com_redshop&view=order_detail&task=displayProductItemInfo";url+=pval,url=url+"&pid="+Math.random()+"&ajaxtask=getproduct&objid="+unique_id,xmlhttp.onreadystatechange=function(){if(4==xmlhttp.readyState){if(document.getElementById("divCalc").innerHTML=xmlhttp.responseText,document.getElementById("change_product_tmp_price"+unique_id)&&"0"==document.getElementById("change_product_tmp_price"+unique_id).value&&(document.getElementById("change_product_tmp_price"+unique_id).value=document.getElementById("product_price_excl_vat").innerHTML),document.getElementById("prdexclprice"+unique_id)&&(document.getElementById("prdexclprice"+unique_id).value=document.getElementById("product_price_excl_vat").innerHTML),document.getElementById("taxprice"+unique_id)&&(document.getElementById("taxprice"+unique_id).value=document.getElementById("total_tax").innerHTML),document.getElementById("prdtax"+unique_id)&&(document.getElementById("prdtax"+unique_id).innerHTML=number_format(document.getElementById("product_tax").innerHTML,redSHOP.RSConfig._("PRICE_DECIMAL"),redSHOP.RSConfig._("PRICE_SEPERATOR"),redSHOP.RSConfig._("THOUSAND_SEPERATOR"))),document.getElementById("product_vatprice"+unique_id)&&(document.getElementById("product_vatprice"+unique_id).value=document.getElementById("product_tax").innerHTML),document.getElementById("prdprice"+unique_id)&&(document.getElementById("prdprice"+unique_id).innerHTML=number_format(document.getElementById("product_price").innerHTML,redSHOP.RSConfig._("PRICE_DECIMAL"),redSHOP.RSConfig._("PRICE_SEPERATOR"),redSHOP.RSConfig._("THOUSAND_SEPERATOR"))),document.getElementById("productprice"+unique_id)&&(document.getElementById("productprice"+unique_id).value=document.getElementById("product_price").innerHTML),document.getElementById("subprice"+unique_id).value=document.getElementById("total_price").innerHTML,document.getElementById("tdtotalprd"+unique_id).innerHTML=number_format(document.getElementById("total_price").innerHTML,redSHOP.RSConfig._("PRICE_DECIMAL"),redSHOP.RSConfig._("PRICE_SEPERATOR"),redSHOP.RSConfig._("THOUSAND_SEPERATOR")),0==newprice&&(document.getElementById("divAtt"+unique_id).innerHTML=document.getElementById("attblock").innerHTML,document.getElementById("divAcc"+unique_id).innerHTML=document.getElementById("accessoryblock").innerHTML,document.getElementById("divUserField"+unique_id).innerHTML=document.getElementById("productuserfield").innerHTML,document.getElementById("tdnote"+unique_id).innerHTML=document.getElementById("noteblock").innerHTML),document.getElementById("tmp_product_price"+unique_id)&&(document.getElementById("tmp_product_price"+unique_id).value=document.getElementById("product_price").innerHTML),document.getElementById("main_price"+unique_id)&&(document.getElementById("main_price"+unique_id).value=document.getElementById("product_price").innerHTML),calculateOfflineTotalPrice(unique_id),document.getElementById("divCalc").innerHTML="",document.getElementById("tdShipping")){var ordertotal=0,ordersubtotal=0;document.getElementById("order_total")&&(ordertotal=parseFloat(document.getElementById("order_total").value)),document.getElementById("order_subtotal")&&(ordersubtotal=parseFloat(document.getElementById("order_subtotal").value));var prdArr=new Array,qntArr=new Array,j=0;for(i=1;i<=rowCount;i++)document.getElementById("product"+i)&&0!=document.getElementById("product"+i).value&&(prdArr[j]=document.getElementById("product"+i).value),document.getElementById("quantityproduct"+i)&&0!=document.getElementById("quantityproduct"+i).value&&(qntArr[j]=document.getElementById("quantityproduct"+i).value),j++;var shipp_users_info_id=0,order_user_id=0;document.getElementById("shipp_users_info_id")&&(shipp_users_info_id=document.getElementById("shipp_users_info_id").value),document.getElementById("user_id")&&(order_user_id=document.getElementById("user_id").value);var newurl="index.php?tmpl=component&option=com_redshop&view=addorder_detail&layout=productorderinfo&ordertotal="+ordertotal+"&ordersubtotal="+ordersubtotal+"&productarr="+prdArr+"&qntarr="+qntArr+"&shipp_users_info_id="+shipp_users_info_id+"&order_user_id="+order_user_id;newxmlhttp=GetXmlHttpObject(),newxmlhttp.onreadystatechange=function(){4==newxmlhttp.readyState&&(document.getElementById("divCalc").innerHTML=newxmlhttp.responseText,document.getElementById("tdShipping").innerHTML=document.getElementById("shippingblock").innerHTML,document.getElementById("tdPayment")&&(document.getElementById("tdPayment").innerHTML=document.getElementById("paymentblock").innerHTML),document.getElementById("divCalc").innerHTML="",calculateOfflineShipping())},newxmlhttp.open("GET",newurl,!0),newxmlhttp.setRequestHeader("X-Requested-With","XMLHttpRequest"),newxmlhttp.send(null)}calendarDefaultLoad();var parser=new DOMParser,doc=parser.parseFromString(xmlhttp.responseText,"text/html"),elem=doc.querySelectorAll("script[id^='inner-ajax-script']")[0];void 0!==elem&&eval(elem.innerHTML)}},xmlhttp.open("GET",url,!0),xmlhttp.setRequestHeader("X-Requested-With","XMLHttpRequest"),xmlhttp.send(null)}else alert("Your browser does not support XMLHTTP!")}function calendarDefaultLoad(){var e=$$(".userfield_input").getElements("img[id^=rs_]"),t=$$(".userfield_input").getElements("input[id^=rs_]"),n=[];t.each(function(e){0<e.length&&n.push(e[0].id)});var d=[];e.each(function(e){0<e.length&&d.push(e[0].id)}),d.each(function(e,t){Calendar.setup({inputField:n[t],ifFormat:"%Y-%m-%d",button:d[t],align:"Tl",singleClick:!0,firstDay:0})})}function changeOfflinePropertyDropdown(e,t,n,d){var o=new Array,r="";prefix=0!=t?d+"acc_":d+"prd_";var l=0;document.getElementById("user_id")&&(l=document.getElementById("user_id").value);var i=prefix+e+"_"+t+"_"+n;if(r=(r=(r=(r=(r=r+"&unique_id="+d)+"&product_id="+e)+"&accessory_id="+t)+"&attribute_id="+n)+"&user_id="+l,document.getElementsByName("property_id_"+i+"[]")){for(var a=document.getElementsByName("property_id_"+i+"[]"),u=0,c=0;c<a.length;c++)"checkbox"==a[c].type?a[c].checked&&(o[u++]=a[c].value):a[c].selectedIndex&&(o[u++]=a[c].options[a[c].selectedIndex].value);r=r+"&property_id="+o.join(",")}var m="index.php?tmpl=component&option=com_redshop&view=addquotation_detail&task=displayOfflineSubProperty"+r;xmlhttp=GetXmlHttpObject(),xmlhttp.onreadystatechange=function(){document.getElementById("property_responce"+i)&&(document.getElementById("property_responce"+i).style.display="none"),4==xmlhttp.readyState&&(document.getElementById("property_responce"+i)&&(document.getElementById("property_responce"+i).innerHTML=xmlhttp.responseText,document.getElementById("property_responce"+i).style.display=""),calculateOfflineTotalPrice(d))},xmlhttp.open("GET",m,!0),xmlhttp.setRequestHeader("X-Requested-With","XMLHttpRequest"),xmlhttp.send(null)}function calculateOfflineTotal(){document.getElementById("tblproductRow");var e=0,t=0;for(i=1;i<=rowCount;i++)document.getElementById("subpriceproduct"+i)&&(e=parseFloat(e)+parseFloat(document.getElementById("subpriceproduct"+i).value)),document.getElementById("taxpriceproduct"+i)&&(t=parseFloat(t)+parseFloat(document.getElementById("taxpriceproduct"+i).value));document.getElementById("divSubTotal")&&(document.getElementById("divSubTotal").innerHTML=number_format(e,redSHOP.RSConfig._("PRICE_DECIMAL"),redSHOP.RSConfig._("PRICE_SEPERATOR"),redSHOP.RSConfig._("THOUSAND_SEPERATOR"))),document.getElementById("order_subtotal")&&(document.getElementById("order_subtotal").value=e),document.getElementById("divTax")&&(document.getElementById("divTax").innerHTML=number_format(t,redSHOP.RSConfig._("PRICE_DECIMAL"),redSHOP.RSConfig._("PRICE_SEPERATOR"),redSHOP.RSConfig._("THOUSAND_SEPERATOR"))),document.getElementById("order_tax")&&(document.getElementById("order_tax").value=t);var n=0;document.getElementById("order_shipping")&&(n=parseFloat(document.getElementById("order_shipping").value)),document.getElementById("divShipping")&&(document.getElementById("divShipping").innerHTML=number_format(n,redSHOP.RSConfig._("PRICE_DECIMAL"),redSHOP.RSConfig._("PRICE_SEPERATOR"),redSHOP.RSConfig._("THOUSAND_SEPERATOR")));var d=parseFloat(e)+parseFloat(n)+parseFloat(t);document.getElementById("divFinalTotal")&&(document.getElementById("divFinalTotal").innerHTML=number_format(d,redSHOP.RSConfig._("PRICE_DECIMAL"),redSHOP.RSConfig._("PRICE_SEPERATOR"),redSHOP.RSConfig._("THOUSAND_SEPERATOR"))),document.getElementById("order_total")&&(document.getElementById("order_total").value=e+t)}function calculateOfflineShipping(){var e;document.getElementById("shipping_rate_id")&&(order_shipping=document.getElementById("shipping_rate_id").value,e="index.php?tmpl=component&option=com_redshop&view=addorder_detail&task=getShippingRate&shipping_rate_id="+order_shipping,xmlhttp=GetXmlHttpObject(),xmlhttp.onreadystatechange=function(){var e,t,n,d;4==xmlhttp.readyState&&(document.getElementById("divCalc").innerHTML=xmlhttp.responseText,e=0,document.getElementById("resultShipping")&&(e=document.getElementById("resultShipping").innerHTML),document.getElementById("resultShippingClass")&&(resultShippingClass=document.getElementById("resultShippingClass").innerHTML,"plgredshop_shippingdefault_shipping_gls"==resultShippingClass?document.getElementById("rs_glslocationId")&&(document.getElementById("rs_glslocationId").style.display="block"):document.getElementById("rs_glslocationId")&&(document.getElementById("rs_glslocationId").style.display="none")),document.getElementById("resultShippingVat")&&(order_shipping_vat=document.getElementById("resultShippingVat").innerHTML),document.getElementById("order_tax").value&&(t=parseFloat(document.getElementById("order_tax").value)+parseFloat(order_shipping_vat),document.getElementById("divTax").innerHTML=number_format(t,redSHOP.RSConfig._("PRICE_DECIMAL"),redSHOP.RSConfig._("PRICE_SEPERATOR"),redSHOP.RSConfig._("THOUSAND_SEPERATOR"))),document.getElementById("divShipping")&&(document.getElementById("divShipping").innerHTML=number_format(e,redSHOP.RSConfig._("PRICE_DECIMAL"),redSHOP.RSConfig._("PRICE_SEPERATOR"),redSHOP.RSConfig._("THOUSAND_SEPERATOR"))),document.getElementById("order_shipping")&&(document.getElementById("order_shipping").value=e),document.getElementById("divCalc").innerHTML="",n=0,document.getElementById("order_total")&&(n=document.getElementById("order_total").value),d=parseFloat(n)+parseFloat(e),document.getElementById("divFinalTotal")&&(document.getElementById("divFinalTotal").innerHTML=number_format(d,redSHOP.RSConfig._("PRICE_DECIMAL"),redSHOP.RSConfig._("PRICE_SEPERATOR"),redSHOP.RSConfig._("THOUSAND_SEPERATOR"))))},xmlhttp.open("GET",e,!0),xmlhttp.setRequestHeader("X-Requested-With","XMLHttpRequest"),xmlhttp.send(null))}function changeOfflinePriceBox(e){var t=0;document.getElementById("prdexclprice"+e)&&""!=trim(document.getElementById("prdexclprice"+e).value)&&!isNaN(document.getElementById("prdexclprice"+e).value)&&(t=document.getElementById("prdexclprice"+e).value),document.getElementById("prdexclprice"+e).value=t,document.getElementById("change_product_tmp_price"+e)&&(document.getElementById("change_product_tmp_price"+e).value=t),displayProductDetailInfo(e,t)}function changeOfflineQuantityBox(e){var t=0;document.getElementById("main_price"+e)&&document.getElementById("product_vatprice"+e)&&(t=parseFloat(document.getElementById("main_price"+e).value)-parseFloat(document.getElementById("product_vatprice"+e).value)),document.getElementById("prdexclprice"+e).value=t,document.getElementById("change_product_tmp_price"+e)&&(t=document.getElementById("change_product_tmp_price"+e).value),displayProductDetailInfo(e,t)}function addItembutton(e){var t=0;document.getElementById(e)&&(t=document.getElementById(e).value),0!=t?(document.getElementById("prdexclprice"+e)&&(document.getElementById("prdexclprice"+e).style.display=""),document.getElementById("quantity"+e)&&(document.getElementById("quantity"+e).style.display=""),document.getElementById("add")&&(document.getElementById("add").style.display="")):(document.getElementById("prdexclprice"+e)&&(document.getElementById("prdexclprice"+e).style.display="none"),document.getElementById("quantity"+e)&&(document.getElementById("quantity"+e).style.display="none"),document.getElementById("add")&&(document.getElementById("add").style.display="none"))}function getQuotationDetail(e){var t,n,d=0,o=0,r=1,l=0;document.getElementById("hiddenqnt"+e)&&0!=document.getElementById("hiddenqnt"+e).value&&(r=document.getElementById("hiddenqnt"+e).value),document.getElementById("user_id")&&(l=document.getElementById("user_id").value),document.getElementById("quantity"+e)&&""!=trim(document.getElementById("quantity"+e).value)&&!isNaN(document.getElementById("quantity"+e).value)&&(r=document.getElementById("quantity"+e).value),document.getElementById("quantity"+e).value=r,document.getElementById("product_excl_price"+e)&&""!=trim(document.getElementById("product_excl_price"+e).value)&&!isNaN(document.getElementById("product_excl_price"+e).value)&&(d=document.getElementById("product_excl_price"+e).value);var i="index.php?tmpl=component&option=com_redshop&view=quotation_detail&task=getQuotationPriceTax"+("&product_id=1&user_id="+l+"&newprice="+(document.getElementById("product_excl_price"+e).value=d));xmlhttp=GetXmlHttpObject(),xmlhttp.onreadystatechange=function(){4==xmlhttp.readyState&&(document.getElementById("divCalc").innerHTML=xmlhttp.responseText,n=parseFloat(document.getElementById("newtax").innerHTML),document.getElementById("divCalc").innerHTML="",t=parseFloat(d)+parseFloat(n),document.getElementById("tdprdprice"+e)&&(document.getElementById("tdprdprice"+e).innerHTML=number_format(t,redSHOP.RSConfig._("PRICE_DECIMAL"),redSHOP.RSConfig._("PRICE_SEPERATOR"),redSHOP.RSConfig._("THOUSAND_SEPERATOR"))),document.getElementById("product_price"+e)&&(document.getElementById("product_price"+e).value=t),document.getElementById("taxprice"+e)&&(document.getElementById("taxprice"+e).value=parseFloat(r)*parseFloat(n)),document.getElementById("totalprice"+e)&&(o=parseFloat(r)*parseFloat(t)),document.getElementById("totalprice"+e).value=o,document.getElementById("tdtotalprice"+e).innerHTML=number_format(o,redSHOP.RSConfig._("PRICE_DECIMAL"),redSHOP.RSConfig._("PRICE_SEPERATOR"),redSHOP.RSConfig._("THOUSAND_SEPERATOR")),calculateQuotationTotal())},xmlhttp.open("GET",i,!0),xmlhttp.setRequestHeader("X-Requested-With","XMLHttpRequest"),xmlhttp.send(null)}function calculateQuotationTotal(){document.getElementById("tblproductRow");var e,t=0,n=0,d=0,o=0,r=document.querySelectorAll("[name*='totalpricep']").length;for(i=1;i<=r;i++)document.getElementById("totalpricep"+i)&&(t=parseFloat(t)+parseFloat(document.getElementById("totalpricep"+i).value),d=parseFloat(d)+parseFloat(document.getElementById("totalpricep"+i).value)),document.getElementById("taxpricep"+i)&&(n=parseFloat(n)+parseFloat(document.getElementById("taxpricep"+i).value));subtot_with_discount=t,document.getElementById("quotation_discount")&&""!=trim(document.getElementById("quotation_discount").value)&&!isNaN(document.getElementById("quotation_discount").value)&&(d<(o=parseFloat(document.getElementById("quotation_discount").value))&&(o=d),vatondiscount=redSHOP.RSConfig._("VAT_RATE_AFTER_DISCOUNT")?parseFloat(o)*redSHOP.RSConfig._("VAT_RATE_AFTER_DISCOUNT")/(1+parseFloat(redSHOP.RSConfig._("VAT_RATE_AFTER_DISCOUNT"))):0,displaytax=parseFloat(n)-parseFloat(vatondiscount),displaydiscount=parseFloat(o)-parseFloat(vatondiscount),displaytotal=d-parseFloat(o),subtot_with_discount-=parseFloat(displaydiscount)),document.getElementById("quotation_special_discount")&&""!=trim(document.getElementById("quotation_special_discount").value)&&!isNaN(document.getElementById("quotation_special_discount").value)&&(e=d*parseFloat(document.getElementById("quotation_special_discount").value)/100,vatonspdiscount=redSHOP.RSConfig._("VAT_RATE_AFTER_DISCOUNT")?parseFloat(e)*redSHOP.RSConfig._("VAT_RATE_AFTER_DISCOUNT")/(1+parseFloat(redSHOP.RSConfig._("VAT_RATE_AFTER_DISCOUNT"))):0,displaytax=parseFloat(displaytax)-parseFloat(vatonspdiscount),displayspdiscount=parseFloat(e)-parseFloat(vatonspdiscount),d=displaytotal-e,subtot_with_discount=subtot_with_discount-parseFloat(e)+parseFloat(vatonspdiscount)),document.getElementById("divMainSubTotalwithDiscount").innerHTML=number_format(subtot_with_discount,redSHOP.RSConfig._("PRICE_DECIMAL"),redSHOP.RSConfig._("PRICE_SEPERATOR"),redSHOP.RSConfig._("THOUSAND_SEPERATOR")),document.getElementById("divMainSubTotal").innerHTML=number_format(t,redSHOP.RSConfig._("PRICE_DECIMAL"),redSHOP.RSConfig._("PRICE_SEPERATOR"),redSHOP.RSConfig._("THOUSAND_SEPERATOR")),document.getElementById("quotation_subtotal").value=t,document.getElementById("divMainFinalTotal").innerHTML=number_format(d,redSHOP.RSConfig._("PRICE_DECIMAL"),redSHOP.RSConfig._("PRICE_SEPERATOR"),redSHOP.RSConfig._("THOUSAND_SEPERATOR")),document.getElementById("quotation_total").value=d,document.getElementById("divMainTax").innerHTML=number_format(displaytax,redSHOP.RSConfig._("PRICE_DECIMAL"),redSHOP.RSConfig._("PRICE_SEPERATOR"),redSHOP.RSConfig._("THOUSAND_SEPERATOR")),document.getElementById("quotation_tax").value=n,document.getElementById("divMainSpecialDiscount").innerHTML=number_format(displayspdiscount,redSHOP.RSConfig._("PRICE_DECIMAL"),redSHOP.RSConfig._("PRICE_SEPERATOR"),redSHOP.RSConfig._("THOUSAND_SEPERATOR")),document.getElementById("divMainDiscount").innerHTML=number_format(displaydiscount,redSHOP.RSConfig._("PRICE_DECIMAL"),redSHOP.RSConfig._("PRICE_SEPERATOR"),redSHOP.RSConfig._("THOUSAND_SEPERATOR"))}function deleteOfflineProductRow(e){var t;window.confirm("Are you sure you want to delete?")&&(t=document.getElementById("trPrd"+e),document.getElementById("tblproductRow").removeChild(t),calculateOfflineTotal())}function displayAddbutton(e,t){var n=document.adminFormAdd;0!=e?(document.getElementById("prdexclprice"+t)&&(document.getElementById("prdexclprice"+t).style.display=""),document.getElementById("quantity"+t)&&(document.getElementById("quantity"+t).style.display=""),n.add.style.display=""):(document.getElementById("prdexclprice"+t)&&(document.getElementById("prdexclprice"+t).style.display="none"),document.getElementById("quantity"+t)&&(document.getElementById("quantity"+t).style.display="none"),n.add.style.display="none")}function extrafieldValidation(e){for(var t,n=e.elements,d="",o="",r=!1,l="",i="",a=!1,u=0;u<n.length;u++)if(extrafields_req=n[u].getAttribute("required"),t=n[u].getAttribute("userfieldlbl"),1==extrafields_req&&null!=t)if("checkbox"==n[u].type){if(o=reverseString(n[u].id),o=reverseString(o.substr(o.indexOf("_")+1)),""!=d&&d!=o&&0==r)return alert(n[u-1].getAttribute("userfieldlbl")+" "+Joomla.JText._("COM_REDSHOP_IS_REQUIRED")),!1;if(d!=o&&(extrafieldVal="",d=o),n[u].checked){r=!0;continue}if(u==n.length-1&&0==r||"checkbox"!=n[u+1].type&&0==r)return alert(n[u].getAttribute("userfieldlbl")+" "+Joomla.JText._("COM_REDSHOP_IS_REQUIRED")),!1}else if("radio"==n[u].type){if(i=reverseString(n[u].id),i=reverseString(i.substr(i.indexOf("_")+1)),""!=l&&l!=i&&0==a)return alert(n[u-1].getAttribute("userfieldlbl")+" "+Joomla.JText._("COM_REDSHOP_IS_REQUIRED")),!1;if(l!=i){if(extrafieldVal="",l=i,a=!1,n[u].checked){a=!0;continue}}else{if(n[u].checked||1==a){a=!0;continue}if(u==n.length-1&&0==a||"radio"!=n[u+1].type&&0==a)return alert(n[u].getAttribute("userfieldlbl")+" "+Joomla.JText._("COM_REDSHOP_IS_REQUIRED")),!1}}else if(!n[u].value)return alert(n[u].getAttribute("userfieldlbl")+" "+Joomla.JText._("COM_REDSHOP_IS_REQUIRED")),!1;return!0}function reverseString(e){return e.split("").reverse().join("")}function createAccount(e){jQuery("#user_valid").html(""),document.getElementById("tblcreat")&&(1==e?(document.getElementById("tblcreat").style.display="",document.getElementById("tblcreat").width="100%"):document.getElementById("tblcreat").style.display="none")}function getStateList(){if(xmlhttp=GetXmlHttpObject(),null!=xmlhttp){for(var e=new Array,t=document.adminForm.shipping_rate_country,n=document.adminForm.shipping_rate_id.value,d=0,o=0;o<t.options.length;o++)1==t.options[o].selected&&(e[d++]=t.options[o].value);var r=(r="index.php?tmpl=component&option=com_redshop&view=shipping_rate_detail&task=GetStateDropdown&shipping_rate_id="+n)+"&country_codes="+e.join(",");xmlhttp.onreadystatechange=function(){4==xmlhttp.readyState&&(document.getElementById("shipping_rate_state").innerHTML=xmlhttp.responseText)},xmlhttp.open("GET",r,!0),xmlhttp.setRequestHeader("X-Requested-With","XMLHttpRequest"),xmlhttp.send(null)}else alert(Joomla.JText._("COM_REDSHOP_BROWSER_NOT_SUPPORT_XMLHTML",""))}function getStateList_Zipcode(){var e=GetXmlHttpObject();if(null!=e){for(var t=new Array,n=document.adminForm.country_code,d=0,o=0;o<n.options.length;o++)1==n.options[o].selected&&(t[d++]=n.options[o].value);$("#s2id_state_code span.select2-chosen").empty();var r="index.php?option=com_redshop&view=zipcode_detail&task=getStateDropdown&country_codes="+t.join(",");e.onreadystatechange=function(){4==e.readyState&&(document.getElementById("state_code").innerHTML=e.responseText)},e.open("GET",r,!0),e.setRequestHeader("X-Requested-With","XMLHttpRequest"),e.send(null)}else alert(Joomla.JText._("COM_REDSHOP_BROWSER_NOT_SUPPORT_XMLHTML",""))}