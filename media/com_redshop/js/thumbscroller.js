var ImageScroller=function(e,t){function M(){_ElementObj=t,_currentOffset=parseInt(_ElementObj.style.left),_currentOffset<0&&_currentOffset+T<=0?(_ElementObj.style.left=_currentOffset+T+"px",O=!0,N=window.setTimeout(M,x)):_currentOffset<0?(_ElementObj.style.left=_currentOffset+1+"px",O=!0,N=window.setTimeout(M,x)):(O=!1,window.clearTimeout(N))}function _(){_ElementObj=t,_currentOffset=parseInt(_ElementObj.style.left),_currentOffset>L&&_currentOffset-T>=L?(_ElementObj.style.left=_currentOffset-T+"px",O=!0,N=window.setTimeout(_,x)):_currentOffset>L?(_ElementObj.style.left=_currentOffset-1+"px",O=!0,N=window.setTimeout(_,x)):(O=!1,window.clearTimeout(N))}function D(){_ElementObj=t,_currentOffset=parseInt(_ElementObj.style.top),_currentOffset>A&&_currentOffset-T>=A?(_ElementObj.style.top=_currentOffset-T+"px",O=!0,N=window.setTimeout(D,x)):_currentOffset>A?(_ElementObj.style.top=_currentOffset-1+"px",O=!0,N=window.setTimeout(D,x)):(O=!1,C++,window.clearTimeout(N),y==1&&(F(S).innerHTML=o[C-1]),g==1&&(F(E).innerHTML=C+"/"+l))}function P(){_ElementObj=t,_currentOffset=parseInt(_ElementObj.style.top),_currentOffset<k&&_currentOffset+T<=k?(_ElementObj.style.top=_currentOffset+T+"px",O=!0,N=window.setTimeout(P,x)):_currentOffset<k?(_ElementObj.style.top=_currentOffset+1+"px",O=!0,N=window.setTimeout(P,x)):(O=!1,C--,window.clearTimeout(N),y==1&&(F(S).innerHTML=o[C-1]),g==1&&(F(E).innerHTML=C+"/"+l))}function H(){_ElementObj=t,_currentOffset=parseInt(_ElementObj.style.left),_currentOffset<k&&_currentOffset+T<=k?(_ElementObj.style.left=_currentOffset+T+"px",O=!0,N=window.setTimeout(H,x)):_currentOffset<k?(_ElementObj.style.left=_currentOffset+1+"px",O=!0,N=window.setTimeout(H,x)):(O=!1,C--,window.clearTimeout(N),y==1&&(F(S).innerHTML=o[C-1]),g==1&&(F(E).innerHTML=C+"/"+l))}function B(){_ElementObj=t,_currentOffset=parseInt(_ElementObj.style.left),_currentOffset>A&&_currentOffset-T>=A?(_ElementObj.style.left=_currentOffset-T+"px",O=!0,N=window.setTimeout(B,x)):_currentOffset>A?(_ElementObj.style.left=_currentOffset-1+"px",O=!0,N=window.setTimeout(B,x)):(O=!1,C++,window.clearTimeout(N),y==1&&(F(S).innerHTML=o[C-1]),g==1&&(F(E).innerHTML=C+"/"+l))}function j(e,t,n){window.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,n)}function F(e){return document.getElementById(e)}e=F(e),t=F(t);var n=new Array,r=new Array,s=new Array,o=new Array,u=new Array,a=new Array,f=1,l,c=0,h=2e3,p=1,d=1,v=1,m=0,g=0,y=0,b=0,w=1,E="",S="",x=1,T=1,N;this.THUMB_HEIGHT=80,this.THUMB_WIDTH=80,this.THUMB_PADDING=4;var C=1,k=0,L=0,A=0,O=!1;this.setNumOfImageToScroll=function(e){w=parseInt(e)},this.enableThumbnailDescription=function(e){y=1,S=e},this.setScrollType=function(e){e==0?v=0:v=1},this.setScrollSpeed=function(e){e>0||e<1e3?x=e+500:x=2},this.setScrollAmount=function(e){e>0||e<1e3?T=e:T=7},this.setClickOpenType=function(e){if(e==0||e==1)b=e},this.enableCurrentCount=function(e){g=1,E=e},this.enableThumbBorder=function(e){m=e},this.setThumbsShown=function(e){f=parseInt(e)},this.addThumbnail=function(e,t,i,f,l,c){n[n.length]=e,s[s.length]=t,r[r.length]=i,o[o.length]=f,u[u.length]=l,a[a.length]=c},this.setThumbnailHeight=function(e){this.THUMB_HEIGHT=e},this.getThumbnailHeight=function(){return this.THUMB_HEIGHT},this.setThumbnailWidth=function(e){this.THUMB_WIDTH=e},this.getThumbnailWidth=function(){return this.THUMB_WIDTH},this.setThumbnailPadding=function(e){this.THUMB_PADDING=e},this.getThumbnailPadding=function(){return THUMB_PADDING},this.getCurrentThumbIndex=function(){return C},this.getThumbnailCount=function(){return l},this.renderScroller=function(){l=n.length,f>l&&(f=l),L=0-(l-f)*this.THUMB_WIDTH,this.THUMB_PADDING>0&&(L-=(l+f)*this.THUMB_PADDING),m==1&&(L-=l*4),v==0?(e.style.width=this.THUMB_WIDTH*f+f*this.THUMB_PADDING*2+"px",m==1&&(e.style.width=parseInt(e.style.width)+f*4+"px"),e.style.height=this.THUMB_HEIGHT+this.THUMB_PADDING*2+2+"px",m==1&&(e.style.height=parseInt(e.style.height)+4+"px"),t.style.width=this.THUMB_WIDTH*l+l*this.THUMB_PADDING*2+"px",/MSIE[\/\s](\d+\.\d+)/.test(navigator.userAgent)&&(t.style.width=this.THUMB_WIDTH*l+this.THUMB_WIDTH+l*this.THUMB_PADDING*2+"px"),m==1&&(t.style.width=parseInt(t.style.width)+l*4+"px")):v==1&&(e.style.width=this.THUMB_WIDTH+this.THUMB_PADDING*2+"px",m==1&&(e.style.width=parseInt(e.style.width)+4+"px"),e.style.height=this.THUMB_HEIGHT*f+f*this.THUMB_PADDING*2+"px",m==1&&(e.style.height=parseInt(e.style.height)+f*4+"px"),t.style.width=this.THUMB_WIDTH+this.THUMB_PADDING*2+"px",m==1&&(t.style.width=parseInt(t.style.width)+4+"px"));var o,c;o=document.createElement("a"),c=document.createElement("img");for(i=0;i<l;i++){o=document.createElement("a"),o.href=s[i],o.title=r[i],/Firefox[\/\s](\d+\.\d+)/.test(navigator.userAgent)&&(o.style.margin="4.5px"),/MSIE[\/\s](\d+\.\d+)/.test(navigator.userAgent)&&(o.style.margin="0px");var h=2;document.all&&(h=4),c=document.createElement("img"),c.src=n[i],c.alt=r[i],c.border=1,c.id=u[i],c.width=this.THUMB_WIDTH,c.height=this.THUMB_HEIGHT,c.style.border=a[i],c.style.padding=this.THUMB_PADDING,o.appendChild(c),t.appendChild(o)}g==1&&j(window,"load",this.updateCurrentCount),y==1&&j(window,"load",this.updateCurrentDescription)},this.stopSmoothScroll=function(){O=!1,window.clearTimeout(N)},this.smoothScrollForward=function(){_origOffset=parseInt(t.style.left),_currentOffset=parseInt(t.style.left),_newOffset=_currentOffset-T,this.THUMB_PADDING>0&&(_newOffset-=2*w*this.THUMB_PADDING),m==1&&(_newOffset-=4),O==0&&_newOffset>=L&&(A=_newOffset,_())},this.stopSmoothScroll=function(){O=!1,window.clearTimeout(N)},this.scrollUp=function(){_origOffset=parseInt(t.style.top),_currentOffset=parseInt(t.style.top),_newOffset=_currentOffset-this.THUMB_HEIGHT*w,this.THUMB_PADDING>0&&(_newOffset-=2*this.THUMB_PADDING),m==1&&(_newOffset-=4),O==0&&_newOffset>=L&&(A=_newOffset,D())},this.scrollDown=function(){_origOffset=parseInt(t.style.top),_currentOffset=parseInt(t.style.top),_newOffset=_currentOffset+this.THUMB_HEIGHT*w,this.THUMB_PADDING>0&&(_newOffset+=2*this.THUMB_PADDING),m==1&&(_newOffset+=4),_newOffset<=0&&_currentOffset>_origOffset-this.THUMB_HEIGHT&&O==0&&_newOffset>=L&&(k=_newOffset,P())},this.scrollTop=function(){O==0&&(A=-1*(l-f)*this.THUMB_HEIGHT,C=l-f,D())},this.scrollBottom=function(){O==0&&(k=0,C=l-f,P())},this.scrollImageCenter=function(e){_origOffset=parseInt(t.style.left),e==0&&(k=0,C=e+1,H());var n=-_origOffset;if(e>0){var r=(e-parseInt(f/2))*(this.THUMB_WIDTH+2*w*this.THUMB_PADDING);n>r?n>0&&(k=-r,C=e+1,H()):r<-L&&(A=-r,C=e+1,B())}},this.smoothScrollReverse=function(){_origOffset=parseInt(t.style.left),_currentOffset=parseInt(t.style.left),_newOffset=_currentOffset+T,this.THUMB_PADDING>0&&(_newOffset+=this.THUMB_PADDING*2*w),m==1&&(_newOffset+=4),_newOffset<=0&&_currentOffset>_origOffset-this.THUMB_WIDTH*w&&O==0&&(k=_newOffset,M())},this.scrollReverse=function(){_origOffset=parseInt(t.style.left),_currentOffset=parseInt(t.style.left),_newOffset=_currentOffset+this.THUMB_WIDTH*w,this.THUMB_PADDING>0&&(_newOffset+=this.THUMB_PADDING*2*w),m==1&&(_newOffset+=4),_newOffset<=0&&_currentOffset>_origOffset-this.THUMB_WIDTH*w&&O==0&&(k=_newOffset,H())},this.scrollForward=function(){_origOffset=parseInt(t.style.left),_currentOffset=parseInt(t.style.left),_newOffset=_currentOffset-this.THUMB_WIDTH*w,this.THUMB_PADDING>0&&(_newOffset-=2*w*this.THUMB_PADDING),m==1&&(_newOffset-=4),O==0&&_newOffset>=L&&(A=_newOffset,B())},this.scrollEnd=function(){O==0&&(A=L,C=l-f,B())},this.scrollBegin=function(){O==0&&(k=0,C=2,H())},this.updateCurrentDescription=function(){F(S).innerHTML=o[C-1]},this.updateCurrentCount=function(){F(E).innerHTML=C+"/"+l}};