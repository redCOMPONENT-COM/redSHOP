"use strict";function updateCartAjax(t,e){var a=e.children("[name=quantity]").val(),r=e.children("[name=productId]").val(),n=e.children("[name=cart_index]").val(),o=e.children("[name=Itemid]").val(),d=redSHOP.RSConfig._("AJAX_TOKEN"),i=redSHOP.RSConfig._("SITE_URL")+"index.php?option=com_redshop&view=cart&task=update&"+d+"=1";t.ajax({type:"POST",url:i,data:{quantity:a,productId:r,cart_index:n,Itemid:o},beforeSend:function(){t('<div id="cart-ajax-loader" style="background: rgba(0,0,0,0.5); position: fixed; width: 100%; height: 100%; z-index: 999; display: flex; align-items: center; justify-content: center; left: 0; top: 0;"><img src="/media/com_redshop/images/reloading.gif" alt="" border="0"></div>').appendTo("body"),t("body").css({overflow:"hidden"})},success:function(e){t("#redshopcomponent").html(t(e).find("#redshopcomponent").html()),t(redSHOP).trigger("onAfterUpdateCartAjax",[e])},complete:function(){t("#cart-ajax-loader").remove(),t("body").css({overflow:""})}})}function getCatalogValidation(){var e=document.frmcatalog,t=e.email_address.value,a=new RegExp("([a-z0-9_]+)@([a-z0-9_-]+)[.][a-z]");return"0"==e.catalog_id.value?(alert(Joomla.JText._("COM_REDSHOP_SELECT_CATALOG")),e.catalog_id.focus(),!1):""==e.name_2.value?(alert(Joomla.JText._("COM_REDSHOP_ENTER_NAME")),e.name_2.focus(),!1):""==t?(alert(Joomla.JText._("COM_REDSHOP_ENTER_AN_EMAIL_ADDRESS")),e.email_address.focus(),!1):0!=a.test(t)||(alert(Joomla.JText._("COM_REDSHOP_EMAIL_ADDRESS_NOT_VALID")),e.email_address.focus(),!1)}redSHOP=window.redSHOP||{},redSHOP.RSConfig={configStrings:{},_:function(e,t){return void 0!==this.configStrings[e.toUpperCase()]?this.configStrings[e.toUpperCase()]:t},load:function(e){for(var t in e)this.configStrings[t.toUpperCase()]=e[t];return this}},redSHOP.AjaxOrderPaymentStatusExecuted=!1,redSHOP.AjaxOrderPaymentStatusCheck=function(){if(jQuery.trim(jQuery("#order_payment_status").html())==Joomla.JText._("COM_REDSHOP_PAYMENT_STA_PAID"))return!1;jQuery.ajax({url:redSHOP.RSConfig._("SITE_URL")+"index.php?option=com_redshop&view=order_detail&task=order_detail.AjaxOrderPaymentStatusCheck&tmpl=component",type:"POST",dataType:"HTML",data:{id:redSHOP.RSConfig._("orderId")}}).done(function(e){jQuery("#order_payment_status").html(e),redSHOP.AjaxOrderPaymentStatusExecuted&&setTimeout("redSHOP.AjaxOrderPaymentStatusCheck()",1e4),redSHOP.AjaxOrderPaymentStatusExecuted=!0}).fail(function(){console.log("error")})},redSHOP.prepareStateList=function(e,a){var t={view:"search",task:"getStatesAjax",country:e.val()};t[redSHOP.RSConfig._("AJAX_TOKEN")]=1,jQuery.ajax({url:redSHOP.RSConfig._("AJAX_BASE_URL"),type:"POST",dataType:"json",data:t}).done(function(e){a.empty(),jQuery("#div_state_txt").hide(),a.parent().hide(),a.hide(),e.length&&(jQuery("#div_state_txt").show(),a.parent().show(),jQuery("#s2id_"+a.attr("id")).length||a.show()),jQuery.each(e,function(e,t){a.append(jQuery("<option></option>").attr("value",t.value).text(t.text))}),a.trigger("change.select2")}).fail(function(){console.log("Error getting state list.")})},jQuery(document).ready(function(t){jQuery(location).attr("search").match(/&layout=receipt/)&&(0<jQuery("#order_payment_status").length?(setTimeout("redSHOP.AjaxOrderPaymentStatusCheck()",1e3),setTimeout("redSHOP.AjaxOrderPaymentStatusCheck()",1e4)):console.warn("Make sure you add #order_payment_status ID in order receipt template")),jQuery(document).on("change",'select[id^="rs_country_"]',function(){redSHOP.prepareStateList(jQuery(this),jQuery("#"+jQuery(this).attr("stateid")))}),t("body").on("change",'form[name^="update_cart"]',function(){updateCartAjax(t,t(this))}).on("keyup keypress keydown",'form[name^="update_cart"]',function(e){13==event.which&&(updateCartAjax(t,t(this)),e.preventDefault())}).on("click","#plus, #minus",function(){var e=t(t(this).closest('form[name^="update_cart"]'));updateCartAjax(t,e)})});