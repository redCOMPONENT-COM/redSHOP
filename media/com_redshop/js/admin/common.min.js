function GetXmlHttpObject(){return window.XMLHttpRequest?new XMLHttpRequest:window.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):null}function updateGLSLocation(e){var t=redSHOP.RSConfig._("SITE_URL")+"index.php?tmpl=component&option=com_redshop&view=checkout&task=updateGLSLocation";t+="&zipcode="+e,jQuery.ajax({url:t,type:"GET"}).done(function(e){jQuery("#rs_locationdropdown").html(e),jQuery('select:not(".disableBootstrapChosen")').select2()}).fail(function(){console.warn("error")})}function number_format(e,t,n,d){var o=e,r=t,l=function(e,t){var n=Math.pow(10,t);return(Math.round(e*n)/n).toString()};o=isFinite(+o)?+o:0,r=isFinite(+r)?Math.abs(r):0;var a,c,i=void 0===d?",":d,u=void 0===n?".":n,m=r>0?l(o,r):l(Math.round(o),r),p=l(Math.abs(o),r);p>=1e3?(a=p.split(/\D/),c=a[0].length%3||3,a[0]=m.slice(0,c+(o<0))+a[0].slice(c).replace(/(\d{3})/g,i+"$1"),m=a.join(u)):m=m.replace(".",u);var _=m.indexOf(u);r>=1&&-1!==_&&m.length-_-1<r?m+=new Array(r-(m.length-_-1)).join(0)+"0":r>=1&&-1===_&&(m+=u+new Array(r).join(0)+"0");return"front"==redSHOP.RSConfig._("CURRENCY_SYMBOL_POSITION")?redSHOP.RSConfig._("REDCURRENCY_SYMBOL")+"&nbsp;"+m:"behind"==redSHOP.RSConfig._("CURRENCY_SYMBOL_POSITION")?m+"&nbsp;"+redSHOP.RSConfig._("REDCURRENCY_SYMBOL"):"none"==redSHOP.RSConfig._("CURRENCY_SYMBOL_POSITION")?m:redSHOP.RSConfig._("REDCURRENCY_SYMBOL")+"&nbsp;"+m}function trim(e,t){return ltrim(rtrim(e,t),t)}function ltrim(e,t){return t=t||"\\s",e.replace(new RegExp("^["+t+"]+","g"),"")}function rtrim(e,t){return t=t||"\\s",e.replace(new RegExp("["+t+"]+$","g"),"")}function collectOfflineAttributes(e,t,n){var d,o=new Array,r=new Array,l=new Array,a=0,c=0,i="";0!=t?(d="acc_",document.getElementById("accessory_id_"+e+"_"+t+n)&&(a=parseFloat(document.getElementById("accessory_id_"+e+"_"+t+n).getAttribute("accessoryprice")),c=parseFloat(document.getElementById("accessory_id_"+e+"_"+t+n).getAttribute("accessorypricevat")))):(d="prd_",document.getElementById("main_price"+n)&&(a=parseFloat(document.getElementById("main_price"+n).value)),document.getElementById("product_vatprice"+n)&&(c=parseFloat(document.getElementById("product_vatprice"+n).value)));var u=n+d+e+"_"+t;if(document.getElementsByName("attribute_id_"+u+"[]"))for(var m=document.getElementsByName("attribute_id_"+u+"[]"),p=0;p<m.length;p++)o[p]=m[p].value;for(var p=0;p<o.length;p++){var _=o[p];u=n+d+e+"_"+t+"_"+_;var y=document.getElementById("property_id_"+u);if(y){for(var E=document.getElementsByName("property_id_"+u+"[]"),g=0,s=new Array,I=0;I<E.length;I++)"checkbox"==E[I].type||"radio"==E[I].type?E[I].checked&&0!=E[I].value&&(s[g++]=E[I].value):E[I].selectedIndex&&0!=E[I].options[E[I].selectedIndex].value&&(s[g++]=E[I].options[E[I].selectedIndex].value);r[p]=s.join(",,"),1==y.getAttribute("required")&&0==s.length&&(document.getElementById("att_lebl")&&(i+=document.getElementById("att_lebl").innerHTML+" "),i+=unescape(y.getAttribute("attribute_name"))+"\n",!0);var B="property_id_"+u+"_oprand",v="property_id_"+u+"_proprice",f="property_id_"+u+"_protax",S=calculateOfflineProductPrice(a,c,B,v,f,s);a=S[1],c=S[2];for(var R=new Array,I=0;I<s.length;I++){var O=s[I],T=n+d+e+"_"+t+"_"+_+"_"+O;if(document.getElementById("subproperty_id_"+T)){!0;var P=document.getElementsByName("subproperty_id_"+T+"[]");g=0;for(var H=new Array,C=0;C<P.length;C++)"checkbox"==P[C].type||"radio"==P[C].type?P[C].checked&&P[C].value&&(H[g++]=P[C].value):P[C].selectedIndex&&P[C].options[P[C].selectedIndex].value&&(H[g++]=P[C].options[P[C].selectedIndex].value);var B="subproperty_id_"+T+"_oprand",v="subproperty_id_"+T+"_proprice",f="subproperty_id_"+T+"_protax",h=calculateOfflineProductPrice(a,c,B,v,f,H);a=h[1],c=h[2],R[I]=H.join("::")}}l[p]=R.join(",,")}}0!=t?(document.getElementById("acc_attribute_data"+n)&&(document.getElementById("acc_attribute_data"+n).value=o.join("##")),document.getElementById("acc_property_data"+n)&&(document.getElementById("acc_property_data"+n).value=r.join("##")),document.getElementById("acc_subproperty_data"+n)&&(document.getElementById("acc_subproperty_data"+n).value=l.join("##")),document.getElementById("accessory_price"+n)&&(document.getElementById("accessory_price"+n).value=a),document.getElementById("accessory_vatprice"+n)&&(document.getElementById("accessory_vatprice"+n).value=c)):(document.getElementById("attribute_data"+n)&&(document.getElementById("attribute_data"+n).value=o.join("##")),document.getElementById("property_data"+n)&&(document.getElementById("property_data"+n).value=r.join("##")),document.getElementById("subproperty_data"+n)&&(document.getElementById("subproperty_data"+n).value=l.join("##")),document.getElementById("tmp_product_price"+n)&&(document.getElementById("tmp_product_price"+n).value=a),document.getElementById("tmp_product_vatprice"+n)&&(document.getElementById("tmp_product_vatprice"+n).value=c)),document.getElementById("requiedAttribute"+n)&&(document.getElementById("requiedAttribute"+n).value=i)}function calculateOfflineProductPrice(e,t,n,d,o,r){for(var l=!0,a=0;a<r.length;a++){var c=r[a],i=document.getElementById(n+c).value,u=document.getElementById(d+c).value,m=document.getElementById(o+c).value;if("-"==i)e-=parseFloat(u),t-=parseFloat(m);else if("+"==i)e+=parseFloat(u),t+=parseFloat(m);else if("*"==i)e*=parseFloat(u),t*=parseFloat(m);else if("/"==i)e/=parseFloat(u),t/=parseFloat(m);else if("="==i){e=parseFloat(u),t=parseFloat(m),l=!1;break}}var p=new Array;return p[0]=l,p[1]=e,p[2]=t,p}function calculateOfflineTotalPrice(e){var t=0;if(document.getElementById(e)&&(0==(t=document.getElementById(e).value)||""==t))return!1;var n=0,d=0,o=collectOfflineAccessory(t,e);document.getElementById("accessory_vatprice"+e)&&(d=o-parseFloat(document.getElementById("accessory_vatprice"+e).value)),collectOfflineAttributes(t,0,e);var r=0;document.getElementById("tmp_product_price"+e)&&(n=parseFloat(document.getElementById("tmp_product_price"+e).value)),document.getElementById("tmp_product_vatprice"+e)&&(r=n-document.getElementById("tmp_product_vatprice"+e).value);var l=0;wprice=setOfflineWrapperComboBox(t,e),document.getElementById("wrapper_vatprice"+e)&&(l=wprice-parseFloat(document.getElementById("wrapper_vatprice"+e).value));var a=0;final_price_f=parseFloat(n)+parseFloat(o)+parseFloat(wprice),a=parseFloat(r)+parseFloat(d)+parseFloat(l),document.getElementById("prdprice"+e)&&(document.getElementById("prdprice"+e).innerHTML=number_format(final_price_f,redSHOP.RSConfig._("PRICE_DECIMAL"),redSHOP.RSConfig._("PRICE_SEPERATOR"),redSHOP.RSConfig._("THOUSAND_SEPERATOR"))),document.getElementById("productprice"+e)&&(document.getElementById("productprice"+e).value=final_price_f),document.getElementById("prdexclprice"+e)&&(document.getElementById("prdexclprice"+e).value=a);var c=1;document.getElementById("quantity"+e)&&""!=trim(document.getElementById("quantity"+e).value)&&!isNaN(document.getElementById("quantity"+e).value)&&(c=document.getElementById("quantity"+e).value),document.getElementById("quantity"+e).value=c,document.getElementById("prdtax"+e)&&(document.getElementById("prdtax"+e).innerHTML=number_format(final_price_f-a,redSHOP.RSConfig._("PRICE_DECIMAL"),redSHOP.RSConfig._("PRICE_SEPERATOR"),redSHOP.RSConfig._("THOUSAND_SEPERATOR"))),document.getElementById("taxprice"+e)&&(document.getElementById("taxprice"+e).value=(final_price_f-a)*c),document.getElementById("subprice"+e)&&(document.getElementById("subprice"+e).value=c*final_price_f),document.getElementById("tdtotalprd"+e)&&(document.getElementById("tdtotalprd"+e).innerHTML=number_format(c*final_price_f,redSHOP.RSConfig._("PRICE_DECIMAL"),redSHOP.RSConfig._("PRICE_SEPERATOR"),redSHOP.RSConfig._("THOUSAND_SEPERATOR"))),calculateOfflineTotal()}function setOfflineWrapperComboBox(e,t){if(0==e||""==e)return!1;var n=0,d=0,o=e+t,r=document.getElementsByName("wrapper_id_"+o+"[]");seli=0;for(var l=new Array,a=0;a<r.length;a++)if(r[a].selectedIndex&&r[a].options[r[a].selectedIndex].value){var c=r[a].options[r[a].selectedIndex].value;document.getElementById("wprice_"+o+"_"+c)&&(n=parseFloat(document.getElementById("wprice_"+o+"_"+c).value)),document.getElementById("wprice_tax_"+o+"_"+c)&&(d=parseFloat(document.getElementById("wprice_tax_"+o+"_"+c).value)),l[seli++]=c}return document.getElementById("wrapper_vatprice"+t)&&(document.getElementById("wrapper_vatprice"+t).value=d),document.getElementById("wrapper_data"+t)&&(document.getElementById("wrapper_data"+t).value=l.join("##")),n}function collectOfflineAccessory(e,t){if(0==e||""==e)return!1;var n=0,d=0,o=0,r=0,l=0,a=new Array,c=new Array,i=new Array,u=new Array;if(document.getElementsByName("accessory_id_"+e+t+"[]")){dcatt=document.getElementsByName("accessory_id_"+e+t+"[]");var m=dcatt.length;for(j=0;j<m;j++){var p=0,_=0,y=dcatt[j].value,E=e+"_"+y+t,g=0;acc_chk=document.getElementById("accessory_id_"+E),document.getElementById("attribute_id_"+E)&&document.getElementById("attribute_id_"+E),g=dcatt[j].checked,g&&(a[l]=y,collectOfflineAttributes(e,y,t),document.getElementById("accessory_price"+t)&&(p=parseFloat(document.getElementById("accessory_price"+t).value)),document.getElementById("accessory_vatprice"+t)&&(_=parseFloat(document.getElementById("accessory_vatprice"+t).value)),document.getElementById("acc_attribute_data"+t)&&(c[l]=document.getElementById("acc_attribute_data"+t).value),document.getElementById("acc_property_data"+t)&&(i[l]=document.getElementById("acc_property_data"+t).value),document.getElementById("acc_subproperty_data"+t)&&(u[l]=document.getElementById("acc_subproperty_data"+t).value),l++),o+=parseFloat(p),r+=parseFloat(_)}n+=parseFloat(o),d+=parseFloat(r),document.getElementById("accessory_data"+t)&&(document.getElementById("accessory_data"+t).value=a.join("@@")),document.getElementById("acc_attribute_data"+t)&&(document.getElementById("acc_attribute_data"+t).value=c.join("@@")),document.getElementById("acc_property_data"+t)&&(document.getElementById("acc_property_data"+t).value=i.join("@@")),document.getElementById("acc_subproperty_data"+t)&&(document.getElementById("acc_subproperty_data"+t).value=u.join("@@")),document.getElementById("accessory_price"+t)&&(document.getElementById("accessory_price"+t).value=n),document.getElementById("accessory_vatprice"+t)&&(document.getElementById("accessory_vatprice"+t).value=d)}return n}function displayProductDetailInfo(e,t){if(xmlhttp=GetXmlHttpObject(),null==xmlhttp)return void alert("Your browser does not support XMLHTTP!");var n=1,d=0,o=0;if(document.getElementById("user_id")&&(o=document.getElementById("user_id").value),document.getElementById(e)&&(d=document.getElementById(e).value),0==d||""==d)return!1;document.getElementById("quantity"+e)&&""!=trim(document.getElementById("quantity"+e).value)&&!isNaN(document.getElementById("quantity"+e).value)&&(n=document.getElementById("quantity"+e).value),document.getElementById("quantity"+e).value=n;var r="&product="+d;r=r+"&quantity="+n,r=r+"&user_id="+o,r=r+"&unique_id="+e,r=r+"&newprice="+t,document.getElementById("order_subtotal")&&(r=r+"&ordertotal="+document.getElementById("order_subtotal").value);var l="index.php?tmpl=component&option=com_redshop&view=order_detail&task=displayProductItemInfo";l+=r,l=l+"&pid="+Math.random()+"&ajaxtask=getproduct&objid="+e,xmlhttp.onreadystatechange=function(){if(4==xmlhttp.readyState){if(document.getElementById("divCalc").innerHTML=xmlhttp.responseText,document.getElementById("change_product_tmp_price"+e)&&"0"==document.getElementById("change_product_tmp_price"+e).value&&(document.getElementById("change_product_tmp_price"+e).value=document.getElementById("product_price_excl_vat").innerHTML),document.getElementById("prdexclprice"+e)&&(document.getElementById("prdexclprice"+e).value=document.getElementById("product_price_excl_vat").innerHTML),document.getElementById("taxprice"+e)&&(document.getElementById("taxprice"+e).value=document.getElementById("total_tax").innerHTML),document.getElementById("prdtax"+e)&&(document.getElementById("prdtax"+e).innerHTML=number_format(document.getElementById("product_tax").innerHTML,redSHOP.RSConfig._("PRICE_DECIMAL"),redSHOP.RSConfig._("PRICE_SEPERATOR"),redSHOP.RSConfig._("THOUSAND_SEPERATOR"))),document.getElementById("product_vatprice"+e)&&(document.getElementById("product_vatprice"+e).value=document.getElementById("product_tax").innerHTML),document.getElementById("prdprice"+e)&&(document.getElementById("prdprice"+e).innerHTML=number_format(document.getElementById("product_price").innerHTML,redSHOP.RSConfig._("PRICE_DECIMAL"),redSHOP.RSConfig._("PRICE_SEPERATOR"),redSHOP.RSConfig._("THOUSAND_SEPERATOR"))),document.getElementById("productprice"+e)&&(document.getElementById("productprice"+e).value=document.getElementById("product_price").innerHTML),document.getElementById("subprice"+e).value=document.getElementById("total_price").innerHTML,document.getElementById("tdtotalprd"+e).innerHTML=number_format(document.getElementById("total_price").innerHTML,redSHOP.RSConfig._("PRICE_DECIMAL"),redSHOP.RSConfig._("PRICE_SEPERATOR"),redSHOP.RSConfig._("THOUSAND_SEPERATOR")),0==t&&(document.getElementById("divAtt"+e).innerHTML=document.getElementById("attblock").innerHTML,document.getElementById("divAcc"+e).innerHTML=document.getElementById("accessoryblock").innerHTML,document.getElementById("divUserField"+e).innerHTML=document.getElementById("productuserfield").innerHTML,document.getElementById("tdnote"+e).innerHTML=document.getElementById("noteblock").innerHTML),document.getElementById("tmp_product_price"+e)&&(document.getElementById("tmp_product_price"+e).value=document.getElementById("product_price").innerHTML),document.getElementById("main_price"+e)&&(document.getElementById("main_price"+e).value=document.getElementById("product_price").innerHTML),calculateOfflineTotalPrice(e),document.getElementById("divCalc").innerHTML="",document.getElementById("tdShipping")){var n=0,d=0;document.getElementById("order_total")&&(n=parseFloat(document.getElementById("order_total").value)),document.getElementById("order_subtotal")&&(d=parseFloat(document.getElementById("order_subtotal").value));var o=new Array,r=new Array,l=0;for(i=1;i<=rowCount;i++)document.getElementById("product"+i)&&0!=document.getElementById("product"+i).value&&(o[l]=document.getElementById("product"+i).value),document.getElementById("quantityproduct"+i)&&0!=document.getElementById("quantityproduct"+i).value&&(r[l]=document.getElementById("quantityproduct"+i).value),l++;var a=0,c=0;document.getElementById("shipp_users_info_id")&&(a=document.getElementById("shipp_users_info_id").value),document.getElementById("user_id")&&(c=document.getElementById("user_id").value);var u="index.php?tmpl=component&option=com_redshop&view=addorder_detail&layout=productorderinfo&ordertotal="+n+"&ordersubtotal="+d+"&productarr="+o+"&qntarr="+r+"&shipp_users_info_id="+a+"&order_user_id="+c;newxmlhttp=GetXmlHttpObject(),newxmlhttp.onreadystatechange=function(){4==newxmlhttp.readyState&&(document.getElementById("divCalc").innerHTML=newxmlhttp.responseText,document.getElementById("tdShipping").innerHTML=document.getElementById("shippingblock").innerHTML,document.getElementById("tdPayment")&&(document.getElementById("tdPayment").innerHTML=document.getElementById("paymentblock").innerHTML),document.getElementById("divCalc").innerHTML="",calculateOfflineShipping())},newxmlhttp.open("GET",u,!0),newxmlhttp.setRequestHeader("X-Requested-With","XMLHttpRequest"),newxmlhttp.send(null)}calendarDefaultLoad()}},xmlhttp.open("GET",l,!0),xmlhttp.setRequestHeader("X-Requested-With","XMLHttpRequest"),xmlhttp.send(null)}function calendarDefaultLoad(){var e=$$(".userfield_input").getElements("img[id^=rs_]"),t=$$(".userfield_input").getElements("input[id^=rs_]"),n=[];t.each(function(e){e.length>0&&n.push(e[0].id)});var d=[];e.each(function(e){e.length>0&&d.push(e[0].id)}),d.each(function(e,t){Calendar.setup({inputField:n[t],ifFormat:"%Y-%m-%d",button:d[t],align:"Tl",singleClick:!0,firstDay:0})})}function changeOfflinePropertyDropdown(e,t,n,d){var o=new Array,r="",l="";prefix=0!=t?d+"acc_":d+"prd_";var a=0;document.getElementById("user_id")&&(a=document.getElementById("user_id").value);var c=prefix+e+"_"+t+"_"+n;if(l=l+"&unique_id="+d,l=l+"&product_id="+e,l=l+"&accessory_id="+t,l=l+"&attribute_id="+n,l=l+"&user_id="+a,document.getElementsByName("property_id_"+c+"[]")){for(var i=document.getElementsByName("property_id_"+c+"[]"),u=0,m=0;m<i.length;m++)"checkbox"==i[m].type?i[m].checked&&(o[u++]=i[m].value):i[m].selectedIndex&&(o[u++]=i[m].options[i[m].selectedIndex].value);r=o.join(","),l=l+"&property_id="+r}var p="index.php?tmpl=component&option=com_redshop&view=addquotation_detail&task=displayOfflineSubProperty";p+=l,xmlhttp=GetXmlHttpObject(),xmlhttp.onreadystatechange=function(){document.getElementById("property_responce"+c)&&(document.getElementById("property_responce"+c).style.display="none"),4==xmlhttp.readyState&&(document.getElementById("property_responce"+c)&&(document.getElementById("property_responce"+c).innerHTML=xmlhttp.responseText,document.getElementById("property_responce"+c).style.display=""),calculateOfflineTotalPrice(d))},xmlhttp.open("GET",p,!0),xmlhttp.setRequestHeader("X-Requested-With","XMLHttpRequest"),xmlhttp.send(null)}function calculateOfflineTotal(){var e=(document.getElementById("tblproductRow"),0),t=0;for(i=1;i<=rowCount;i++)document.getElementById("subpriceproduct"+i)&&(e=parseFloat(e)+parseFloat(document.getElementById("subpriceproduct"+i).value)),document.getElementById("taxpriceproduct"+i)&&(t=parseFloat(t)+parseFloat(document.getElementById("taxpriceproduct"+i).value));document.getElementById("divSubTotal")&&(document.getElementById("divSubTotal").innerHTML=number_format(e,redSHOP.RSConfig._("PRICE_DECIMAL"),redSHOP.RSConfig._("PRICE_SEPERATOR"),redSHOP.RSConfig._("THOUSAND_SEPERATOR"))),document.getElementById("order_subtotal")&&(document.getElementById("order_subtotal").value=e),document.getElementById("divTax")&&(document.getElementById("divTax").innerHTML=number_format(t,redSHOP.RSConfig._("PRICE_DECIMAL"),redSHOP.RSConfig._("PRICE_SEPERATOR"),redSHOP.RSConfig._("THOUSAND_SEPERATOR"))),document.getElementById("order_tax")&&(document.getElementById("order_tax").value=t);var n=0;document.getElementById("order_shipping")&&(n=parseFloat(document.getElementById("order_shipping").value)),document.getElementById("divShipping")&&(document.getElementById("divShipping").innerHTML=number_format(n,redSHOP.RSConfig._("PRICE_DECIMAL"),redSHOP.RSConfig._("PRICE_SEPERATOR"),redSHOP.RSConfig._("THOUSAND_SEPERATOR")));var d=parseFloat(e)+parseFloat(n);document.getElementById("divFinalTotal")&&(document.getElementById("divFinalTotal").innerHTML=number_format(d,redSHOP.RSConfig._("PRICE_DECIMAL"),redSHOP.RSConfig._("PRICE_SEPERATOR"),redSHOP.RSConfig._("THOUSAND_SEPERATOR"))),document.getElementById("order_total")&&(document.getElementById("order_total").value=e)}function calculateOfflineShipping(){if(document.getElementById("shipping_rate_id")){order_shipping=document.getElementById("shipping_rate_id").value;var e="index.php?tmpl=component&option=com_redshop&view=addorder_detail&task=getShippingRate&shipping_rate_id="+order_shipping;xmlhttp=GetXmlHttpObject(),xmlhttp.onreadystatechange=function(){if(4==xmlhttp.readyState){document.getElementById("divCalc").innerHTML=xmlhttp.responseText;var e=0;if(document.getElementById("resultShipping")&&(e=document.getElementById("resultShipping").innerHTML),document.getElementById("resultShippingClass")&&(resultShippingClass=document.getElementById("resultShippingClass").innerHTML,"plgredshop_shippingdefault_shipping_gls"==resultShippingClass?document.getElementById("rs_glslocationId")&&(document.getElementById("rs_glslocationId").style.display="block"):document.getElementById("rs_glslocationId")&&(document.getElementById("rs_glslocationId").style.display="none")),document.getElementById("resultShippingVat")&&(order_shipping_vat=document.getElementById("resultShippingVat").innerHTML),document.getElementById("order_tax").value){var t=parseFloat(document.getElementById("order_tax").value)+parseFloat(order_shipping_vat);document.getElementById("divTax").innerHTML=number_format(t,redSHOP.RSConfig._("PRICE_DECIMAL"),redSHOP.RSConfig._("PRICE_SEPERATOR"),redSHOP.RSConfig._("THOUSAND_SEPERATOR"))}document.getElementById("divShipping")&&(document.getElementById("divShipping").innerHTML=number_format(e,redSHOP.RSConfig._("PRICE_DECIMAL"),redSHOP.RSConfig._("PRICE_SEPERATOR"),redSHOP.RSConfig._("THOUSAND_SEPERATOR"))),document.getElementById("order_shipping")&&(document.getElementById("order_shipping").value=e),document.getElementById("divCalc").innerHTML="";var n=0;document.getElementById("order_total")&&(n=document.getElementById("order_total").value);var d=parseFloat(n)+parseFloat(e);document.getElementById("divFinalTotal")&&(document.getElementById("divFinalTotal").innerHTML=number_format(d,redSHOP.RSConfig._("PRICE_DECIMAL"),redSHOP.RSConfig._("PRICE_SEPERATOR"),redSHOP.RSConfig._("THOUSAND_SEPERATOR")))}},xmlhttp.open("GET",e,!0),xmlhttp.setRequestHeader("X-Requested-With","XMLHttpRequest"),xmlhttp.send(null)}}function changeOfflinePriceBox(e){var t=0;document.getElementById("prdexclprice"+e)&&""!=trim(document.getElementById("prdexclprice"+e).value)&&!isNaN(document.getElementById("prdexclprice"+e).value)&&(t=document.getElementById("prdexclprice"+e).value),document.getElementById("prdexclprice"+e).value=t,document.getElementById("change_product_tmp_price"+e)&&(document.getElementById("change_product_tmp_price"+e).value=t),displayProductDetailInfo(e,t)}function changeOfflineQuantityBox(e){var t=0;document.getElementById("main_price"+e)&&document.getElementById("product_vatprice"+e)&&(t=parseFloat(document.getElementById("main_price"+e).value)-parseFloat(document.getElementById("product_vatprice"+e).value)),document.getElementById("prdexclprice"+e).value=t,document.getElementById("change_product_tmp_price"+e)&&(t=document.getElementById("change_product_tmp_price"+e).value),displayProductDetailInfo(e,t)}function addItembutton(e){var t=0;document.getElementById(e)&&(t=document.getElementById(e).value),0!=t?(document.getElementById("prdexclprice"+e)&&(document.getElementById("prdexclprice"+e).style.display=""),document.getElementById("quantity"+e)&&(document.getElementById("quantity"+e).style.display=""),document.getElementById("add")&&(document.getElementById("add").style.display="")):(document.getElementById("prdexclprice"+e)&&(document.getElementById("prdexclprice"+e).style.display="none"),document.getElementById("quantity"+e)&&(document.getElementById("quantity"+e).style.display="none"),document.getElementById("add")&&(document.getElementById("add").style.display="none"))}function getQuotationDetail(e){var t=0,n=0,d=0,o=0,r=1,l=0;document.getElementById("hiddenqnt"+e)&&0!=document.getElementById("hiddenqnt"+e).value&&(r=document.getElementById("hiddenqnt"+e).value),document.getElementById("user_id")&&(l=document.getElementById("user_id").value),document.getElementById("quantity"+e)&&""!=trim(document.getElementById("quantity"+e).value)&&!isNaN(document.getElementById("quantity"+e).value)&&(r=document.getElementById("quantity"+e).value),document.getElementById("quantity"+e).value=r,document.getElementById("product_excl_price"+e)&&""!=trim(document.getElementById("product_excl_price"+e).value)&&!isNaN(document.getElementById("product_excl_price"+e).value)&&(n=document.getElementById("product_excl_price"+e).value),document.getElementById("product_excl_price"+e).value=n;var a="&product_id=1";a=a+"&user_id="+l,a=a+"&newprice="+n;var c="index.php?tmpl=component&option=com_redshop&view=quotation_detail&task=getQuotationPriceTax";c+=a,xmlhttp=GetXmlHttpObject(),xmlhttp.onreadystatechange=function(){4==xmlhttp.readyState&&(document.getElementById("divCalc").innerHTML=xmlhttp.responseText,o=parseFloat(document.getElementById("newtax").innerHTML),document.getElementById("divCalc").innerHTML="",t=parseFloat(n)+parseFloat(o),document.getElementById("tdprdprice"+e)&&(document.getElementById("tdprdprice"+e).innerHTML=number_format(t,redSHOP.RSConfig._("PRICE_DECIMAL"),redSHOP.RSConfig._("PRICE_SEPERATOR"),redSHOP.RSConfig._("THOUSAND_SEPERATOR"))),document.getElementById("product_price"+e)&&(document.getElementById("product_price"+e).value=t),document.getElementById("taxprice"+e)&&(document.getElementById("taxprice"+e).value=parseFloat(r)*parseFloat(o)),document.getElementById("totalprice"+e)&&(d=parseFloat(r)*parseFloat(t)),document.getElementById("totalprice"+e).value=d,document.getElementById("tdtotalprice"+e).innerHTML=number_format(d,redSHOP.RSConfig._("PRICE_DECIMAL"),redSHOP.RSConfig._("PRICE_SEPERATOR"),redSHOP.RSConfig._("THOUSAND_SEPERATOR")),calculateQuotationTotal())},xmlhttp.open("GET",c,!0),xmlhttp.setRequestHeader("X-Requested-With","XMLHttpRequest"),xmlhttp.send(null)}function calculateQuotationTotal(){var e=(document.getElementById("tblproductRow"),0),t=0,n=0,d=0,o=0,r=0,l=document.querySelectorAll("[name*='totalpricep']").length;for(i=1;i<=l;i++)document.getElementById("totalpricep"+i)&&(e=parseFloat(e)+parseFloat(document.getElementById("totalpricep"+i).value),n=parseFloat(n)+parseFloat(document.getElementById("totalpricep"+i).value)),document.getElementById("taxpricep"+i)&&(t=parseFloat(t)+parseFloat(document.getElementById("taxpricep"+i).value));n=n,subtot_with_discount=e,document.getElementById("quotation_discount")&&""!=trim(document.getElementById("quotation_discount").value)&&!isNaN(document.getElementById("quotation_discount").value)&&(d=parseFloat(document.getElementById("quotation_discount").value),redSHOP.RSConfig._("VAT_RATE_AFTER_DISCOUNT")?vatondiscount=parseFloat(d)*redSHOP.RSConfig._("VAT_RATE_AFTER_DISCOUNT")/(1+parseFloat(redSHOP.RSConfig._("VAT_RATE_AFTER_DISCOUNT"))):vatondiscount=0,displaytax=parseFloat(t)-parseFloat(vatondiscount),displaydiscount=parseFloat(d)-parseFloat(vatondiscount),displaytotal=n-parseFloat(d),subtot_with_discount-=parseFloat(displaydiscount)),document.getElementById("quotation_special_discount")&&""!=trim(document.getElementById("quotation_special_discount").value)&&!isNaN(document.getElementById("quotation_special_discount").value)&&(o=parseFloat(document.getElementById("quotation_special_discount").value),r=n*o/100,redSHOP.RSConfig._("VAT_RATE_AFTER_DISCOUNT")?vatonspdiscount=parseFloat(r)*redSHOP.RSConfig._("VAT_RATE_AFTER_DISCOUNT")/(1+parseFloat(redSHOP.RSConfig._("VAT_RATE_AFTER_DISCOUNT"))):vatonspdiscount=0,displaytax=parseFloat(displaytax)-parseFloat(vatonspdiscount),displayspdiscount=parseFloat(r)-parseFloat(vatonspdiscount),n=displaytotal-r,subtot_with_discount=subtot_with_discount-parseFloat(r)+parseFloat(vatonspdiscount)),document.getElementById("divMainSubTotalwithDiscount").innerHTML=number_format(subtot_with_discount,redSHOP.RSConfig._("PRICE_DECIMAL"),redSHOP.RSConfig._("PRICE_SEPERATOR"),redSHOP.RSConfig._("THOUSAND_SEPERATOR")),document.getElementById("divMainSubTotal").innerHTML=number_format(e,redSHOP.RSConfig._("PRICE_DECIMAL"),redSHOP.RSConfig._("PRICE_SEPERATOR"),redSHOP.RSConfig._("THOUSAND_SEPERATOR")),document.getElementById("quotation_subtotal").value=e,document.getElementById("divMainFinalTotal").innerHTML=number_format(n,redSHOP.RSConfig._("PRICE_DECIMAL"),redSHOP.RSConfig._("PRICE_SEPERATOR"),redSHOP.RSConfig._("THOUSAND_SEPERATOR")),document.getElementById("quotation_total").value=n,document.getElementById("divMainTax").innerHTML=number_format(displaytax,redSHOP.RSConfig._("PRICE_DECIMAL"),redSHOP.RSConfig._("PRICE_SEPERATOR"),redSHOP.RSConfig._("THOUSAND_SEPERATOR")),document.getElementById("quotation_tax").value=t,document.getElementById("divMainSpecialDiscount").innerHTML=number_format(displayspdiscount,redSHOP.RSConfig._("PRICE_DECIMAL"),redSHOP.RSConfig._("PRICE_SEPERATOR"),redSHOP.RSConfig._("THOUSAND_SEPERATOR")),document.getElementById("divMainDiscount").innerHTML=number_format(displaydiscount,redSHOP.RSConfig._("PRICE_DECIMAL"),redSHOP.RSConfig._("PRICE_SEPERATOR"),redSHOP.RSConfig._("THOUSAND_SEPERATOR"))}function deleteOfflineProductRow(e){if(window.confirm("Are you sure you want to delete?")){var t=document.getElementById("trPrd"+e);document.getElementById("tblproductRow").removeChild(t),calculateOfflineTotal()}}function displayAddbutton(e,t){var n=document.adminFormAdd;0!=e?(document.getElementById("prdexclprice"+t)&&(document.getElementById("prdexclprice"+t).style.display=""),document.getElementById("quantity"+t)&&(document.getElementById("quantity"+t).style.display=""),n.add.style.display=""):(document.getElementById("prdexclprice"+t)&&(document.getElementById("prdexclprice"+t).style.display="none"),document.getElementById("quantity"+t)&&(document.getElementById("quantity"+t).style.display="none"),n.add.style.display="none")}function extrafieldValidation(e){for(var t=e.elements,n="",d="",o="",r=!1,l="",a="",c=!1,i=0;i<t.length;i++)if(extrafields_req=t[i].getAttribute("required"),n=t[i].getAttribute("userfieldlbl"),1==extrafields_req&&null!=n)if("checkbox"==t[i].type){if(o=reverseString(t[i].id),o=reverseString(o.substr(o.indexOf("_")+1)),""!=d&&d!=o&&0==r)return alert(t[i-1].getAttribute("userfieldlbl")+" "+Joomla.JText._("COM_REDSHOP_IS_REQUIRED")),!1;if(d!=o&&(extrafieldVal="",d=o),t[i].checked){r=!0;continue}if(i==t.length-1&&0==r||"checkbox"!=t[i+1].type&&0==r)return alert(t[i].getAttribute("userfieldlbl")+" "+Joomla.JText._("COM_REDSHOP_IS_REQUIRED")),!1}else if("radio"==t[i].type){if(a=reverseString(t[i].id),a=reverseString(a.substr(a.indexOf("_")+1)),""!=l&&l!=a&&0==c)return alert(t[i-1].getAttribute("userfieldlbl")+" "+Joomla.JText._("COM_REDSHOP_IS_REQUIRED")),!1;if(l!=a){if(extrafieldVal="",l=a,c=!1,t[i].checked){c=!0;continue}}else{if(t[i].checked||1==c){c=!0;continue}if(i==t.length-1&&0==c||"radio"!=t[i+1].type&&0==c)return alert(t[i].getAttribute("userfieldlbl")+" "+Joomla.JText._("COM_REDSHOP_IS_REQUIRED")),!1}}else if(!t[i].value)return alert(t[i].getAttribute("userfieldlbl")+" "+Joomla.JText._("COM_REDSHOP_IS_REQUIRED")),!1;return!0}function reverseString(e){return e.split("").reverse().join("")}function createAccount(e){jQuery("#user_valid").html(""),document.getElementById("tblcreat")&&(1==e?(document.getElementById("tblcreat").style.display="",document.getElementById("tblcreat").width="100%"):document.getElementById("tblcreat").style.display="none")}function getStateList(){if(xmlhttp=GetXmlHttpObject(),null==xmlhttp)return void alert("Your browser does not support XMLHTTP!");for(var e=new Array,t=document.adminForm.shipping_rate_country,n=document.adminForm.shipping_rate_id.value,d=0,o=0;o<t.options.length;o++)1==t.options[o].selected&&(e[d++]=t.options[o].value);var r="index.php?tmpl=component&option=com_redshop&view=shipping_rate_detail&task=GetStateDropdown&shipping_rate_id="+n;r=r+"&country_codes="+e.join(","),xmlhttp.onreadystatechange=function(){4==xmlhttp.readyState&&(document.getElementById("changestate").innerHTML=xmlhttp.responseText)},xmlhttp.open("GET",r,!0),xmlhttp.setRequestHeader("X-Requested-With","XMLHttpRequest"),xmlhttp.send(null)}