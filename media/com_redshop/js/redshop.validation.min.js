var JSONstring,request,user_valid=1,email_valid=1;function getHTTPObject(){var a=!1;if(window.XMLHttpRequest)a=new XMLHttpRequest;else if(window.ActiveXObject)try{a=new ActiveXObject("Msxml2.XMLHTTP")}catch(b){try{a=new ActiveXObject("Microsoft.XMLHTTP")}catch(c){a=!1}}return a}function resetTermsCondition(){return!!(document.getElementById("show_terms_and_conditions1")&&1==document.getElementById("show_terms_and_conditions1").checked&&confirm("Are you sure you want to reset"))&&((request=getHTTPObject()).open("GET","index.php?option=com_redshop&view=configuration&task=resetTermsCondition&tmpl=component",!0),request.setRequestHeader("X-Requested-With","XMLHttpRequest"),request.send(null),!0)}function changeBookInvoice(a){2==a?document.getElementById("booking_order_status")&&(document.getElementById("booking_order_status").style.display=""):document.getElementById("booking_order_status")&&(document.getElementById("booking_order_status").style.display="none")}function templateData(){if(4==request.readyState){document.getElementById("dynamic_field").innerHTML=request.responseText;var a=getElementsByClass("calendar",null,"img");for(i=0;i<a.length;i++){n=(arr=a[i].id.split("_img")).length;var d=arr[0],b=/[rs_]*/;"rs_"==d.match(b)&&window.addEvent("domready",function(){Calendar.setup({inputField:d,ifFormat:"%d-%m-%Y",button:a[i].id,align:"Tl",singleClick:!0})})}var a=getElementsByClass("mce_editable",null,"textarea");for(i=0;i<a.length;i++){var c=a[i].id,b=/[rs_]*/;if("rs_"==c.match(b))return tinyMCE.execCommand("mceToggleEditor",!1,c),!1}}}function getElementsByClass(e,a,b){var d=new Array;null==a&&(a=document),null==b&&(b="*");var c=a.getElementsByTagName(b),g=c.length,h=new RegExp("(^|\\s)"+e+"(\\s|$)");for(i=0,j=0;i<g;i++)h.test(c[i].className)&&(d[j]=c[i],j++);return d}function validate(c){var b=document.forms.adminForm,a=new Object;return(a.ind=c,a.userid=b.id.value?b.id.value:b.user_id.value,a.username=b.username.value,a.email=b.email.value,""==a.username)?(user_valid=0,document.getElementById("user_valid").style.color="red",document.getElementById("user_valid").innerHTML="User Field can't be blank",!1):2==c&&1==user_valid&&""==a.email?(email_valid=0,document.getElementById("email_valid").style.color="red",document.getElementById("email_valid").innerHTML="E-mail Field can't be blank",!1):!1!=validateemail(b.email)&&void(JSONstring=JSON.stringify(a),(request=getHTTPObject()).onreadystatechange=function(){if(4==request.readyState){var b=request.responseText,a=JSON.parse(b);1==a.ind?user_valid=1==a.username?0:1:email_valid=1==a.email?0:1,0==user_valid?(document.getElementById("user_valid").style.color="red",document.getElementById("user_valid").innerHTML="User already exist"):(document.getElementById("user_valid").style.color="green",document.getElementById("user_valid").innerHTML="Username is available"),0==email_valid?(document.getElementById("email_valid").style.color="red",document.getElementById("email_valid").innerHTML="Email already exist"):(document.getElementById("email_valid").style.color="green",document.getElementById("email_valid").innerHTML="Email is available")}},request.open("GET","index.php?option=com_redshop&view=user_detail&task=validation&json="+JSONstring,!0),request.setRequestHeader("X-Requested-With","XMLHttpRequest"),request.send(null))}function checkmail(b){if(b.length<=0)return!0;var a=b.match("^(.+)@(.+)$");if(null==a)return!1;if(null!=a[1]){var c=/^\"?[\w-_\.]*\"?$/;if(null==a[1].match(c))return!1}if(null!=a[2]){var d=/^[\w-\.]*\.[A-Za-z]{2,4}$/;if(null==a[2].match(d)){var e=/^\[\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\]$/;if(null==a[2].match(e))return!1}return!0}return!1}function validateemail(b){var a;if(!checkmail(email=b.value))return a&&0!=a.length||(a="Enter valid Email address "),document.getElementById("email_valid").innerHTML=a,!1}function mail_order_status(){if(4==request.readyState){var a=request.responseText,b=JSON.parse(a);document.getElementById("responce").innerHTML=b.order_statusHtml;try{document.getElementById("order_state").style.display="table-row",document.getElementById("order_state_edit").style.display="none"}catch(c){document.getElementById("order_state").style.display="block",document.getElementById("order_state_edit").style.display="none"}}}var f=0;function addNewcolor(e){var d=document.getElementById("color_code_1").value;""==d&&document.getElementById("catalog_image").value,parseInt(document.getElementById("total_extra").value),parseInt(f);var g=document.getElementById(e).getElementsByTagName("tbody")[0],a=document.createElement("tr"),b=document.createElement("td"),c=document.createElement("td");""!=d?(is_img=0,code_img=document.getElementById("color_code_1").value,b.innerHTML='<div style=" width:100px:height:100px;background-color:'+code_img+'">&nbsp;</div>'):(is_img=1,code_img=document.getElementById("catalog_image").value,b.innerHTML=document.getElementById("image_dis").innerHTML),c.innerHTML='<input type="hidden" name="colour_id[]" id="colour_id[]">  <input value="Delete" onclick="deletecolor(this)" class="button" type="button" />',c.innerHTML+='<input type="hidden" value="'+code_img+'" name="code_image[]"  id="code_image[]"><input type="hidden" name="is_image[]" value="'+is_img+'" id="is_image[]">',a.appendChild(b),a.appendChild(c),g.appendChild(a),document.getElementById("color_code_1").value="",document.getElementById("catalog_image").value="",document.getElementById("image_display").src="",f++}function deletecolor(a){var b=a.parentNode.parentNode.rowIndex;document.getElementById("extra_table").deleteRow(b)}function xml_object(){var a;try{a=new XMLHttpRequest}catch(b){try{a=new ActiveXObject("Msxml2.XMLHTTP")}catch(c){try{a=new ActiveXObject("Microsoft.XMLHTTP")}catch(d){return alert("Your browser does not support AJAX!"),!1}}}return a}var rtask="",id=0;function removePropertyImage(b,a){id=b,rtask=a,!0==confirm(WANT_TO_DELETE)&&((request=getHTTPObject()).onreadystatechange=removeImageRes,request.open("GET","index.php?tmpl=component&option=com_redshop&view=product_detail&task=remove"+a+"Image&pid="+id,!0),request.setRequestHeader("X-Requested-With","XMLHttpRequest"),request.send(null))}function removeImageRes(){if(4==request.readyState){var a=rtask+"_image_"+id,b=request.responseText;document.getElementById(a)&&""!=b&&(document.getElementById(a).style.display="none")}}function getElementsByClassName(c){var b=new Array,a=document.all?document.all:document.getElementsByTagName("*");for(i=0,j=0;i<a.length;i++)a[i].className==c&&(b[j]=a[i],j++);return b}function setProductUserFieldImage(g,h,d,b){if(getElementsByClassName("imgClass_"+h),document.getElementById(g)){hasClass(b,"selectedimg")?removeClass(b,"selectedimg"):b.className+=" selectedimg";for(var c=document.getElementsByName("imgField[]"),e=new Array,i=0,a=0;a<c.length;a++)hasClass(c[a],"selectedimg")&&(e[i++]=c[a].id);document.getElementById("imgFieldId"+d)&&(document.getElementById("imgFieldId"+d).value=e.join(","))}}function setProductImageLink(b,h,e,c){if(document.getElementsByClassName("imgClass_"+h),document.getElementById(b)){hasClass(c,"selectedimg")?(removeClass(c,"selectedimg"),document.getElementById("hover_link"+b).style.display="none"):(c.className+=" selectedimg",document.getElementById("hover_link"+b).style.display="block");for(var d=document.getElementsByName("imgField[]"),g=new Array,i=0,a=0;a<d.length;a++)hasClass(d[a],"selectedimg")&&(g[i++]=d[a].id);document.getElementById("imgFieldId"+e)&&(document.getElementById("imgFieldId"+e).value=g.join(","))}}function removeClass(a,b){if(hasClass(a,b)){var c=new RegExp("(\\s|^)"+b+"(\\s|$)");a.className=a.className.replace(c," ")}}function hasClass(a,b){return a.className.match(new RegExp("(\\s|^)"+b+"(\\s|$)"))}function delimg(b,a,c,d){var e=a;(xmlhttp=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")).onreadystatechange=function(){4==xmlhttp.readyState&&200==xmlhttp.status?(document.getElementById(a).innerHTML=xmlhttp.responseText,document.getElementById(a).style.display="none"):document.getElementById(e).innerHTML="<img src='"+redSHOP.RSConfig._("SITE_URL")+"/components/com_redshop/assets/images/loading.gif' />"},xmlhttp.open("GET","index.php?option=com_redshop&view=configuration&task=removeimg&imname="+b+"&divname="+a+"&data_id="+d+"&spath="+c,!0),xmlhttp.setRequestHeader("X-Requested-With","XMLHttpRequest"),xmlhttp.send(null)}function showOfflineCompanyOrCustomer(a){1==a?(document.getElementById("trCompanyName")&&(document.getElementById("trCompanyName").style.display=""),document.getElementById("trEANnumber")&&(document.getElementById("trEANnumber").style.display=""),document.getElementById("trReqnumber")&&(document.getElementById("trReqnumber").style.display=""),document.getElementById("trVatNumber")&&(document.getElementById("trVatNumber").style.display=""),document.getElementById("divContact")&&(document.getElementById("divContact").style.display=""),document.getElementById("divFirstname")&&(document.getElementById("divFirstname").style.display=""),document.getElementById("trLastname")&&(document.getElementById("trLastname").style.display=""),document.getElementById("trTaxExempt")&&(document.getElementById("trTaxExempt").style.display=""),document.getElementById("trTaxExemptRequest")&&(document.getElementById("trTaxExemptRequest").style.display=""),document.getElementById("trTaxExemptApproved")&&(document.getElementById("trTaxExemptApproved").style.display=""),document.getElementById("exCompanyField")&&(document.getElementById("exCompanyField").style.display=""),document.getElementById("exCustomerField")&&(document.getElementById("exCustomerField").style.display="none"),document.getElementById("exCompanyFieldST")&&(document.getElementById("exCompanyFieldST").style.display=""),document.getElementById("exCustomerFieldST")&&(document.getElementById("exCustomerFieldST").style.display="none")):(document.getElementById("trCompanyName")&&(document.getElementById("trCompanyName").style.display="none"),document.getElementById("trEANnumber")&&(document.getElementById("trEANnumber").style.display="none"),document.getElementById("trReqnumber")&&(document.getElementById("trReqnumber").style.display="none"),document.getElementById("trVatNumber")&&(document.getElementById("trVatNumber").style.display="none"),document.getElementById("divContact")&&(document.getElementById("divContact").style.display="none"),document.getElementById("divFirstname")&&(document.getElementById("divFirstname").style.display=""),document.getElementById("trLastname")&&(document.getElementById("trLastname").style.display=""),document.getElementById("trTaxExempt")&&(document.getElementById("trTaxExempt").style.display="none"),document.getElementById("trTaxExemptRequest")&&(document.getElementById("trTaxExemptRequest").style.display="none"),document.getElementById("trTaxExemptApproved")&&(document.getElementById("trTaxExemptApproved").style.display="none"),document.getElementById("exCompanyField")&&(document.getElementById("exCompanyField").style.display="none"),document.getElementById("exCustomerField")&&(document.getElementById("exCustomerField").style.display=""),document.getElementById("exCompanyFieldST")&&(document.getElementById("exCompanyFieldST").style.display="none"),document.getElementById("exCustomerFieldST")&&(document.getElementById("exCustomerFieldST").style.display=""))}function showOfflineCompanyOrCustomerST(a){1==a?(document.getElementById("trCompanyNameST")&&(document.getElementById("trCompanyNameST").style.display=""),document.getElementById("exCompanyFieldST")&&(document.getElementById("exCompanyFieldST").style.display=""),document.getElementById("exCustomerFieldST")&&(document.getElementById("exCustomerFieldST").style.display="none")):(document.getElementById("trCompanyNameST")&&(document.getElementById("trCompanyNameST").style.display="none"),document.getElementById("exCompanyFieldST")&&(document.getElementById("exCompanyFieldST").style.display="none"),document.getElementById("exCustomerFieldST")&&(document.getElementById("exCustomerFieldST").style.display=""))}function getvatremove(a){document.installform.vattax_rate_id.value=a,document.installform.vatremove.value="1",document.installform.submit()}function validateExtrafield(t){for(var a=t.elements,k="",g=0,h=[],b=0;b<a.length;b++){var d=a[b].type,y=a[b].getAttribute("name"),u=a[b].getAttribute("id"),v=a[b].getAttribute("required"),c=a[b].getAttribute("reqlbl");null==c&&(c=a[b].getAttribute("userfieldlbl")),null==c&&(c=a[b].getAttribute("attribute_name"));var i=a[b].getAttribute("errormsg");null==i&&(i=Joomla.JText._("COM_REDSHOP_IS_REQUIRED"));var w=a[b].value;if(null!=v&&1==v&&null!=c){if(("text"==d||"textarea"==d)&&(""==trim(w)?(k+=c+" : "+i+"\n",a[b].style.borderColor="red",g=1):""!=trim(w)&&(a[b].style.borderColor="")),"select-multiple"==d||"select-one"==d){var z=t.product1.value,l=0;-1==a[b].options.selectedIndex&&(l=1);for(var p=0;p<a[b].options.length;p++)!0==a[b].options[p].selected&&0==a[b].options[p].value&&(l=1);if(-1!==u.indexOf("property_id_product1acc_"+z)){var q=u.split("_");jQuery("input[type='checkbox']#accessory_id_"+q[3]+"_"+q[4]+"product1").length>0&&0===jQuery("input[type='checkbox']#accessory_id_"+q[3]+"_"+q[4]+"product1:checked").length&&(l=0)}if(1==l){for(var m=!1,e=0,s=h.length;e<s;e++)if(h[e]==a[b].getAttribute("name")){m=!0;break}m||(h.push(a[b].getAttribute("name")),k+=c+" : "+i+" \n",a[b].parentNode.style.border="solid 1px red",g=1)}else 0==l&&(a[b].parentNode.style.border="none")}if("radio"==d||"checkbox"==d){var n=a[y],j=0;if(n.length>1)for(var o=0;o<n.length;o++)"null"!=typeof n[o].getAttribute("required")&&1==n[o].getAttribute("required")&&n[o].checked&&(j=1);else a[b].checked&&(j=1);if(0==j){for(var r=0;r<a.length;r++)if(a[b].getAttribute("name")==a[r].getAttribute("name")&&a[r].checked){j=1;break}}if(0==j){for(var m=!1,e=0,s=h.length;e<s;e++)if(h[e]==a[b].getAttribute("name")){m=!0;break}m||(h.push(a[b].getAttribute("name")),k+=c+" : "+i+" \n",a[b].parentNode.style.border="solid 1px red",g=1)}else 1==j&&(a[b].parentNode.style.border="none")}if("file"==d){var A=document.getElementById(a[b].id).value,x="";document.getElementById("hidden"+a[b].id)&&(x=document.getElementById("hidden"+a[b].id).value),""==A&&""==x?(k+=c+" : "+i+" \n",a[b].style.borderColor="red",g=1):0==g&&(a[b].style.borderColor="")}}}return 1!=g||(alert(k),!1)}jQuery(document).ready(function(){jQuery("#username").blur(function(){if(1==jQuery('input[name="guestuser"]:checked').val()){var a={username:jQuery("#username").val(),user_id:jQuery("input[name=user_id]").val()};a[jQuery("input[name=token]").val()]=1,jQuery.ajax({url:"index.php?option=com_redshop&view=user_detail&task=ajaxValidationUsername",type:"GET",data:a,success:function(a){a=JSON.parse("{"+a.substring(a.indexOf("{")+1)),jQuery("#user_valid").html(a.message),jQuery("#user_valid").css("color","green"),"error"==a.type&&jQuery("#user_valid").css("color","red")},error:function(){}})}}),jQuery(document).on("keydown","input[name*='phone']",function(a){-1===jQuery.inArray(a.keyCode,[46,8,9,27,13,107,109,110,190])&&(65!==a.keyCode|| !0!==a.ctrlKey&& !0!==a.metaKey)&&(!(a.keyCode>=35)||!(a.keyCode<=40))&&(a.shiftKey||a.keyCode<48||a.keyCode>57)&&(a.keyCode<96||a.keyCode>105)&&a.preventDefault()}),jQuery(document).on("keydown","input[name*='phone_ST']",function(a){-1===jQuery.inArray(a.keyCode,[46,8,9,27,13,107,109,110,190])&&(65!==a.keyCode|| !0!==a.ctrlKey&& !0!==a.metaKey)&&(!(a.keyCode>=35)||!(a.keyCode<=40))&&(a.shiftKey||a.keyCode<48||a.keyCode>57)&&(a.keyCode<96||a.keyCode>105)&&a.preventDefault()})})