var JSONstring,request,user_valid=1,email_valid=1;function getHTTPObject(){var e=!1;if(window.XMLHttpRequest)e=new XMLHttpRequest;else if(window.ActiveXObject)try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{e=new ActiveXObject("Microsoft.XMLHTTP")}catch(l){e=!1}}return e}function resetTermsCondition(){return!!(document.getElementById("show_terms_and_conditions1")&&1==document.getElementById("show_terms_and_conditions1").checked&&confirm("Are you sure you want to reset"))&&((request=getHTTPObject()).open("GET","index.php?option=com_redshop&view=configuration&task=resetTermsCondition&tmpl=component",!0),request.setRequestHeader("X-Requested-With","XMLHttpRequest"),request.send(null),!0)}function changeBookInvoice(e){2==e?document.getElementById("booking_order_status")&&(document.getElementById("booking_order_status").style.display=""):document.getElementById("booking_order_status")&&(document.getElementById("booking_order_status").style.display="none")}function templateData(){if(4==request.readyState){document.getElementById("dynamic_field").innerHTML=request.responseText;var e=getElementsByClass("calendar",null,"img");for(i=0;i<e.length;i++){n=(arr=e[i].id.split("_img")).length;var t=arr[0],l=/[rs_]*/;"rs_"==t.match(l)&&window.addEvent("domready",function(){Calendar.setup({inputField:t,ifFormat:"%d-%m-%Y",button:e[i].id,align:"Tl",singleClick:!0})})}var e=getElementsByClass("mce_editable",null,"textarea");for(i=0;i<e.length;i++){var a=e[i].id,l=/[rs_]*/;if("rs_"==a.match(l))return tinyMCE.execCommand("mceToggleEditor",!1,a),!1}}}function getElementsByClass(e,t,l){var a=[];null==t&&(t=document),null==l&&(l="*");var d=t.getElementsByTagName(l),r=d.length,s=RegExp("(^|\\s)"+e+"(\\s|$)");for(i=0,j=0;i<r;i++)s.test(d[i].className)&&(a[j]=d[i],j++);return a}function validate(e){var t=document.forms.adminForm,l={};return(l.ind=e,l.userid=t.id.value?t.id.value:t.user_id.value,l.username=t.username.value,l.email=t.email.value,""==l.username)?(user_valid=0,document.getElementById("user_valid").style.color="red",document.getElementById("user_valid").innerHTML="User Field can't be blank",!1):2==e&&1==user_valid&&""==l.email?(email_valid=0,document.getElementById("email_valid").style.color="red",document.getElementById("email_valid").innerHTML="E-mail Field can't be blank",!1):!1!=validateemail(t.email)&&void(JSONstring=JSON.stringify(l),(request=getHTTPObject()).onreadystatechange=function(){if(4==request.readyState){var e=JSON.parse(request.responseText);1==e.ind?user_valid=1==e.username?0:1:email_valid=1==e.email?0:1,0==user_valid?(document.getElementById("user_valid").style.color="red",document.getElementById("user_valid").innerHTML="User already exist"):(document.getElementById("user_valid").style.color="green",document.getElementById("user_valid").innerHTML="Username is available"),0==email_valid?(document.getElementById("email_valid").style.color="red",document.getElementById("email_valid").innerHTML="Email already exist"):(document.getElementById("email_valid").style.color="green",document.getElementById("email_valid").innerHTML="Email is available")}},request.open("GET","index.php?option=com_redshop&view=user_detail&task=validation&json="+JSONstring,!0),request.setRequestHeader("X-Requested-With","XMLHttpRequest"),request.send(null))}function checkmail(e){if(e.length<=0)return!0;var t=e.match("^(.+)@(.+)$");return null!=t&&(null==t[1]||null!=t[1].match(/^\"?[\w-_\.]*\"?$/))&&null!=t[2]&&(null!=t[2].match(/^[\w-\.]*\.[A-Za-z]{2,4}$/)||null!=t[2].match(/^\[\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\]$/))}function validateemail(e){var t;if(!checkmail(email=e.value))return t&&0!=t.length||(t="Enter valid Email address "),document.getElementById("email_valid").innerHTML=t,!1}function mail_order_status(){if(4==request.readyState){var e=JSON.parse(request.responseText);document.getElementById("responce").innerHTML=e.order_statusHtml;try{document.getElementById("order_state").style.display="table-row",document.getElementById("order_state_edit").style.display="none"}catch(t){document.getElementById("order_state").style.display="block",document.getElementById("order_state_edit").style.display="none"}}}var f=0;function addNewcolor(e){var t=document.getElementById("color_code_1").value;""==t&&document.getElementById("catalog_image").value,parseInt(document.getElementById("total_extra").value),parseInt(f);var l=document.getElementById(e).getElementsByTagName("tbody")[0],a=document.createElement("tr"),d=document.createElement("td"),r=document.createElement("td");""!=t?(is_img=0,code_img=document.getElementById("color_code_1").value,d.innerHTML='<div style=" width:100px:height:100px;background-color:'+code_img+'">&nbsp;</div>'):(is_img=1,code_img=document.getElementById("catalog_image").value,d.innerHTML=document.getElementById("image_dis").innerHTML),r.innerHTML='<input type="hidden" name="colour_id[]" id="colour_id[]">  <input value="Delete" onclick="deletecolor(this)" class="button" type="button" />',r.innerHTML+='<input type="hidden" value="'+code_img+'" name="code_image[]"  id="code_image[]"><input type="hidden" name="is_image[]" value="'+is_img+'" id="is_image[]">',a.appendChild(d),a.appendChild(r),l.appendChild(a),document.getElementById("color_code_1").value="",document.getElementById("catalog_image").value="",document.getElementById("image_display").src="",f++}function deletecolor(e){var t=e.parentNode.parentNode.rowIndex;document.getElementById("extra_table").deleteRow(t)}function xml_object(){var e;try{e=new XMLHttpRequest}catch(t){try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(l){try{e=new ActiveXObject("Microsoft.XMLHTTP")}catch(a){return alert("Your browser does not support AJAX!"),!1}}}return e}var rtask="",id=0;function removePropertyImage(e,t){id=e,rtask=t,!0==confirm(WANT_TO_DELETE)&&((request=getHTTPObject()).onreadystatechange=removeImageRes,request.open("GET","index.php?tmpl=component&option=com_redshop&view=product_detail&task=remove"+t+"Image&pid="+id,!0),request.setRequestHeader("X-Requested-With","XMLHttpRequest"),request.send(null))}function removeImageRes(){if(4==request.readyState){var e=rtask+"_image_"+id,t=request.responseText;document.getElementById(e)&&""!=t&&(document.getElementById(e).style.display="none")}}function getElementsByClassName(e){var t=[],l=document.all?document.all:document.getElementsByTagName("*");for(i=0,j=0;i<l.length;i++)l[i].className==e&&(t[j]=l[i],j++);return t}function setProductUserFieldImage(e,t,l,a){if(getElementsByClassName("imgClass_"+t),document.getElementById(e)){hasClass(a,"selectedimg")?removeClass(a,"selectedimg"):a.className+=" selectedimg";for(var d=document.getElementsByName("imgField[]"),r=[],s=0,m=0;m<d.length;m++)hasClass(d[m],"selectedimg")&&(r[s++]=d[m].id);document.getElementById("imgFieldId"+l)&&(document.getElementById("imgFieldId"+l).value=r.join(","))}}function setProductImageLink(e,t,l,a){if(document.getElementsByClassName("imgClass_"+t),document.getElementById(e)){hasClass(a,"selectedimg")?(removeClass(a,"selectedimg"),document.getElementById("hover_link"+e).style.display="none"):(a.className+=" selectedimg",document.getElementById("hover_link"+e).style.display="block");for(var d=document.getElementsByName("imgField[]"),r=[],s=0,m=0;m<d.length;m++)hasClass(d[m],"selectedimg")&&(r[s++]=d[m].id);document.getElementById("imgFieldId"+l)&&(document.getElementById("imgFieldId"+l).value=r.join(","))}}function removeClass(e,t){if(hasClass(e,t)){var l=RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(l," ")}}function hasClass(e,t){return e.className.match(RegExp("(\\s|^)"+t+"(\\s|$)"))}function delimg(e,t,l,a){var d=t;(xmlhttp=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")).onreadystatechange=function(){4==xmlhttp.readyState&&200==xmlhttp.status?(document.getElementById(t).innerHTML=xmlhttp.responseText,document.getElementById(t).style.display="none"):document.getElementById(d).innerHTML="<img src='"+redSHOP.RSConfig._("SITE_URL")+"/components/com_redshop/assets/images/loading.gif' />"},xmlhttp.open("GET","index.php?option=com_redshop&view=configuration&task=removeimg&imname="+e+"&divname="+t+"&data_id="+a+"&spath="+l,!0),xmlhttp.setRequestHeader("X-Requested-With","XMLHttpRequest"),xmlhttp.send(null)}function showOfflineCompanyOrCustomer(e){1==e?(document.getElementById("trCompanyName")&&(document.getElementById("trCompanyName").style.display=""),document.getElementById("trEANnumber")&&(document.getElementById("trEANnumber").style.display=""),document.getElementById("trReqnumber")&&(document.getElementById("trReqnumber").style.display=""),document.getElementById("trVatNumber")&&(document.getElementById("trVatNumber").style.display=""),document.getElementById("divContact")&&(document.getElementById("divContact").style.display=""),document.getElementById("divFirstname")&&(document.getElementById("divFirstname").style.display=""),document.getElementById("trLastname")&&(document.getElementById("trLastname").style.display=""),document.getElementById("trTaxExempt")&&(document.getElementById("trTaxExempt").style.display=""),document.getElementById("trTaxExemptRequest")&&(document.getElementById("trTaxExemptRequest").style.display=""),document.getElementById("trTaxExemptApproved")&&(document.getElementById("trTaxExemptApproved").style.display=""),document.getElementById("exCompanyField")&&(document.getElementById("exCompanyField").style.display=""),document.getElementById("exCustomerField")&&(document.getElementById("exCustomerField").style.display="none"),document.getElementById("exCompanyFieldST")&&(document.getElementById("exCompanyFieldST").style.display=""),document.getElementById("exCustomerFieldST")&&(document.getElementById("exCustomerFieldST").style.display="none")):(document.getElementById("trCompanyName")&&(document.getElementById("trCompanyName").style.display="none"),document.getElementById("trEANnumber")&&(document.getElementById("trEANnumber").style.display="none"),document.getElementById("trReqnumber")&&(document.getElementById("trReqnumber").style.display="none"),document.getElementById("trVatNumber")&&(document.getElementById("trVatNumber").style.display="none"),document.getElementById("divContact")&&(document.getElementById("divContact").style.display="none"),document.getElementById("divFirstname")&&(document.getElementById("divFirstname").style.display=""),document.getElementById("trLastname")&&(document.getElementById("trLastname").style.display=""),document.getElementById("trTaxExempt")&&(document.getElementById("trTaxExempt").style.display="none"),document.getElementById("trTaxExemptRequest")&&(document.getElementById("trTaxExemptRequest").style.display="none"),document.getElementById("trTaxExemptApproved")&&(document.getElementById("trTaxExemptApproved").style.display="none"),document.getElementById("exCompanyField")&&(document.getElementById("exCompanyField").style.display="none"),document.getElementById("exCustomerField")&&(document.getElementById("exCustomerField").style.display=""),document.getElementById("exCompanyFieldST")&&(document.getElementById("exCompanyFieldST").style.display="none"),document.getElementById("exCustomerFieldST")&&(document.getElementById("exCustomerFieldST").style.display=""))}function showOfflineCompanyOrCustomerST(e){1==e?(document.getElementById("trCompanyNameST")&&(document.getElementById("trCompanyNameST").style.display=""),document.getElementById("exCompanyFieldST")&&(document.getElementById("exCompanyFieldST").style.display=""),document.getElementById("exCustomerFieldST")&&(document.getElementById("exCustomerFieldST").style.display="none")):(document.getElementById("trCompanyNameST")&&(document.getElementById("trCompanyNameST").style.display="none"),document.getElementById("exCompanyFieldST")&&(document.getElementById("exCompanyFieldST").style.display="none"),document.getElementById("exCustomerFieldST")&&(document.getElementById("exCustomerFieldST").style.display=""))}function getvatremove(e){document.installform.vattax_rate_id.value=e,document.installform.vatremove.value="1",document.installform.submit()}function validateExtrafield(e){for(var t=e.elements,l="",a=0,d=[],r=0;r<t.length;r++){var s=t[r].type,m=t[r].getAttribute("name"),o=t[r].getAttribute("id"),y=t[r].getAttribute("required"),u=t[r].getAttribute("reqlbl");null==u&&(u=t[r].getAttribute("userfieldlbl")),null==u&&(u=t[r].getAttribute("attribute_name"));var g=t[r].getAttribute("errormsg");null==g&&(g=Joomla.JText._("COM_REDSHOP_IS_REQUIRED"));var p=t[r].value;if(null!=y&&1==y&&null!=u){if(("text"==s||"textarea"==s)&&(""==trim(p)?(l+=u+" : "+g+"\n",t[r].style.borderColor="red",a=1):""!=trim(p)&&(t[r].style.borderColor="")),"select-multiple"==s||"select-one"==s){var c=e.product1.value,E=0;-1==t[r].options.selectedIndex&&(E=1);for(var v=0;v<t[r].options.length;v++)!0==t[r].options[v].selected&&0==t[r].options[v].value&&(E=1);if(-1!==o.indexOf("property_id_product1acc_"+c)){var I=o.split("_");jQuery("input[type='checkbox']#accessory_id_"+I[3]+"_"+I[4]+"product1").length>0&&0===jQuery("input[type='checkbox']#accessory_id_"+I[3]+"_"+I[4]+"product1:checked").length&&(E=0)}if(1==E){for(var B=!1,h=0,T=d.length;h<T;h++)if(d[h]==t[r].getAttribute("name")){B=!0;break}B||(d.push(t[r].getAttribute("name")),l+=u+" : "+g+" \n",t[r].parentNode.style.border="solid 1px red",a=1)}else 0==E&&(t[r].parentNode.style.border="none")}if("radio"==s||"checkbox"==s){var C=t[m],x=0;if(C.length>1)for(var _=0;_<C.length;_++)"null"!=typeof C[_].getAttribute("required")&&1==C[_].getAttribute("required")&&C[_].checked&&(x=1);else t[r].checked&&(x=1);if(0==x){for(var b=0;b<t.length;b++)if(t[r].getAttribute("name")==t[b].getAttribute("name")&&t[b].checked){x=1;break}}if(0==x){for(var B=!1,h=0,T=d.length;h<T;h++)if(d[h]==t[r].getAttribute("name")){B=!0;break}B||(d.push(t[r].getAttribute("name")),l+=u+" : "+g+" \n",t[r].parentNode.style.border="solid 1px red",a=1)}else 1==x&&(t[r].parentNode.style.border="none")}if("file"==s){var $=document.getElementById(t[r].id).value,k="";document.getElementById("hidden"+t[r].id)&&(k=document.getElementById("hidden"+t[r].id).value),""==$&&""==k?(l+=u+" : "+g+" \n",t[r].style.borderColor="red",a=1):0==a&&(t[r].style.borderColor="")}}}return 1!=a||(alert(l),!1)}jQuery(document).ready(function(){jQuery("#username").blur(function(){if(1==jQuery('input[name="guestuser"]:checked').val()){var e={username:jQuery("#username").val(),user_id:jQuery("input[name=user_id]").val()};e[jQuery("input[name=token]").val()]=1,jQuery.ajax({url:"index.php?option=com_redshop&view=user_detail&task=ajaxValidationUsername",type:"GET",data:e,success:function(e){e=JSON.parse("{"+e.substring(e.indexOf("{")+1)),jQuery("#user_valid").html(e.message),jQuery("#user_valid").css("color","green"),"error"==e.type&&jQuery("#user_valid").css("color","red")},error:function(){}})}}),jQuery(document).on("keydown","input[name*='phone']",function(e){-1===jQuery.inArray(e.keyCode,[46,8,9,27,13,107,109,110,190])&&(65!==e.keyCode||!0!==e.ctrlKey&&!0!==e.metaKey)&&(!(e.keyCode>=35)||!(e.keyCode<=40))&&(e.shiftKey||e.keyCode<48||e.keyCode>57)&&(e.keyCode<96||e.keyCode>105)&&e.preventDefault()}),jQuery(document).on("keydown","input[name*='phone_ST']",function(e){-1===jQuery.inArray(e.keyCode,[46,8,9,27,13,107,109,110,190])&&(65!==e.keyCode||!0!==e.ctrlKey&&!0!==e.metaKey)&&(!(e.keyCode>=35)||!(e.keyCode<=40))&&(e.shiftKey||e.keyCode<48||e.keyCode>57)&&(e.keyCode<96||e.keyCode>105)&&e.preventDefault()})});