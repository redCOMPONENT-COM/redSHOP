var JSONstring,request,user_valid=1,email_valid=1;function getHTTPObject(){var t=!1;if(window.XMLHttpRequest)t=new XMLHttpRequest;else if(window.ActiveXObject)try{t=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{t=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){t=!1}}return t}function resetTermsCondition(){return!(!document.getElementById("show_terms_and_conditions1")||1!=document.getElementById("show_terms_and_conditions1").checked||!confirm("Are you sure you want to reset"))&&((request=getHTTPObject()).open("GET","index.php?option=com_redshop&view=configuration&task=resetTermsCondition&tmpl=component",!0),request.setRequestHeader("X-Requested-With","XMLHttpRequest"),request.send(null),!0)}function changeBookInvoice(e){2==e?document.getElementById("booking_order_status")&&(document.getElementById("booking_order_status").style.display=""):document.getElementById("booking_order_status")&&(document.getElementById("booking_order_status").style.display="none")}function templateData(){if(4==request.readyState){document.getElementById("dynamic_field").innerHTML=request.responseText;var e=getElementsByClass("calendar",null,"img");for(i=0;i<e.length;i++){var t=e[i].id;arr=t.split("_img"),n=arr.length;var d=arr[0],l=/[rs_]*/;"rs_"==d.match(l)&&window.addEvent("domready",function(){Calendar.setup({inputField:d,ifFormat:"%d-%m-%Y",button:e[i].id,align:"Tl",singleClick:!0})})}e=getElementsByClass("mce_editable",null,"textarea");for(i=0;i<e.length;i++){var r=e[i].id;l=/[rs_]*/;if("rs_"==r.match(l))return tinyMCE.execCommand("mceToggleEditor",!1,r),!1}}}function getElementsByClass(e,t,n){var d=new Array;null==t&&(t=document),null==n&&(n="*");var l=t.getElementsByTagName(n),r=l.length,a=new RegExp("(^|\\s)"+e+"(\\s|$)");for(i=0,j=0;i<r;i++)a.test(l[i].className)&&(d[j]=l[i],j++);return d}function validate(e){var t=document.forms.adminForm,n=new Object;return n.ind=e,n.userid=t.id.value?t.id.value:t.user_id.value,n.username=t.username.value,n.email=t.email.value,""==n.username?(user_valid=0,document.getElementById("user_valid").style.color="red",!(document.getElementById("user_valid").innerHTML="User Field can't be blank")):2==e&&1==user_valid&&""==n.email?(email_valid=0,document.getElementById("email_valid").style.color="red",!(document.getElementById("email_valid").innerHTML="E-mail Field can't be blank")):0!=validateemail(t.email)&&(JSONstring=JSON.stringify(n),(request=getHTTPObject()).onreadystatechange=function(){if(4==request.readyState){var e=request.responseText,t=JSON.parse(e);1==t.ind?user_valid=1==t.username?0:1:email_valid=1==t.email?0:1,0==user_valid?(document.getElementById("user_valid").style.color="red",document.getElementById("user_valid").innerHTML="User already exist"):(document.getElementById("user_valid").style.color="green",document.getElementById("user_valid").innerHTML="Username is available"),0==email_valid?(document.getElementById("email_valid").style.color="red",document.getElementById("email_valid").innerHTML="Email already exist"):(document.getElementById("email_valid").style.color="green",document.getElementById("email_valid").innerHTML="Email is available")}},request.open("GET","index.php?option=com_redshop&view=user_detail&task=validation&json="+JSONstring,!0),request.setRequestHeader("X-Requested-With","XMLHttpRequest"),void request.send(null))}function checkmail(e){if(e.length<=0)return!0;var t=e.match("^(.+)@(.+)$");if(null==t)return!1;if(null!=t[1]){if(null==t[1].match(/^\"?[\w-_\.]*\"?$/))return!1}if(null==t[2])return!1;if(null==t[2].match(/^[\w-\.]*\.[A-Za-z]{2,4}$/)){if(null==t[2].match(/^\[\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\]$/))return!1}return!0}function validateemail(e){var t;if(email=e.value,!checkmail(email))return t&&0!=t.length||(t="Enter valid Email address "),document.getElementById("email_valid").innerHTML=t,!1}function mail_order_status(){if(4==request.readyState){var e=request.responseText,t=JSON.parse(e);document.getElementById("responce").innerHTML=t.order_statusHtml;try{document.getElementById("order_state").style.display="table-row",document.getElementById("order_state_edit").style.display="none"}catch(e){document.getElementById("order_state").style.display="block",document.getElementById("order_state_edit").style.display="none"}}}var f=0;function addNewcolor(e){var t=document.getElementById("color_code_1").value;if(""==t)document.getElementById("catalog_image").value;parseInt(document.getElementById("total_extra").value),parseInt(f);var n=document.getElementById(e).getElementsByTagName("tbody")[0],d=document.createElement("tr"),l=document.createElement("td"),r=document.createElement("td");""!=t?(is_img=0,code_img=document.getElementById("color_code_1").value,l.innerHTML='<div style=" width:100px:height:100px;background-color:'+code_img+'">&nbsp;</div>'):(is_img=1,code_img=document.getElementById("catalog_image").value,l.innerHTML=document.getElementById("image_dis").innerHTML),r.innerHTML='<input type="hidden" name="colour_id[]" id="colour_id[]">  <input value="Delete" onclick="deletecolor(this)" class="button" type="button" />',r.innerHTML+='<input type="hidden" value="'+code_img+'" name="code_image[]"  id="code_image[]"><input type="hidden" name="is_image[]" value="'+is_img+'" id="is_image[]">',d.appendChild(l),d.appendChild(r),n.appendChild(d),document.getElementById("color_code_1").value="",document.getElementById("catalog_image").value="",document.getElementById("image_display").src="",f++}function deletecolor(e){var t=e.parentNode.parentNode.rowIndex;document.getElementById("extra_table").deleteRow(t)}function xml_object(){var t;try{t=new XMLHttpRequest}catch(e){try{t=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{t=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){return alert("Your browser does not support AJAX!"),!1}}}return t}var rtask="",id=0;function removePropertyImage(e,t){id=e,rtask=t,1==confirm(WANT_TO_DELETE)&&((request=getHTTPObject()).onreadystatechange=removeImageRes,request.open("GET","index.php?tmpl=component&option=com_redshop&view=product_detail&task=remove"+t+"Image&pid="+id,!0),request.setRequestHeader("X-Requested-With","XMLHttpRequest"),request.send(null))}function removeImageRes(){if(4==request.readyState){var e=rtask+"_image_"+id,t=request.responseText;document.getElementById(e)&&""!=t&&(document.getElementById(e).style.display="none")}}function getElementsByClassName(e){var t=new Array,n=document.all?document.all:document.getElementsByTagName("*");for(i=0,j=0;i<n.length;i++)n[i].className==e&&(t[j]=n[i],j++);return t}function setProductUserFieldImage(e,t,n,d){getElementsByClassName("imgClass_"+t);if(document.getElementById(e)){hasClass(d,"selectedimg")?removeClass(d,"selectedimg"):d.className+=" selectedimg";for(var l=document.getElementsByName("imgField[]"),r=new Array,a=0,m=0;m<l.length;m++)hasClass(l[m],"selectedimg")&&(r[a++]=l[m].id);document.getElementById("imgFieldId"+n)&&(document.getElementById("imgFieldId"+n).value=r.join(","))}}function setProductImageLink(e,t,n,d){document.getElementsByClassName("imgClass_"+t);if(document.getElementById(e)){hasClass(d,"selectedimg")?(removeClass(d,"selectedimg"),document.getElementById("hover_link"+e).style.display="none"):(d.className+=" selectedimg",document.getElementById("hover_link"+e).style.display="block");for(var l=document.getElementsByName("imgField[]"),r=new Array,a=0,m=0;m<l.length;m++)hasClass(l[m],"selectedimg")&&(r[a++]=l[m].id);document.getElementById("imgFieldId"+n)&&(document.getElementById("imgFieldId"+n).value=r.join(","))}}function removeClass(e,t){if(hasClass(e,t)){var n=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(n," ")}}function hasClass(e,t){return e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))}function delimg(e,t,n,d){var l=t;xmlhttp=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),xmlhttp.onreadystatechange=function(){4==xmlhttp.readyState&&200==xmlhttp.status?(document.getElementById(t).innerHTML=xmlhttp.responseText,document.getElementById(t).style.display="none"):document.getElementById(l).innerHTML="<img src='"+redSHOP.RSConfig._("SITE_URL")+"/components/com_redshop/assets/images/loading.gif' />"};var r="index.php?option=com_redshop&view=configuration&task=removeimg&imname="+e+"&divname="+t+"&data_id="+d+"&spath="+n;xmlhttp.open("GET",r,!0),xmlhttp.setRequestHeader("X-Requested-With","XMLHttpRequest"),xmlhttp.send(null)}function showOfflineCompanyOrCustomer(e){1==e?(document.getElementById("trCompanyName")&&(document.getElementById("trCompanyName").style.display=""),document.getElementById("trEANnumber")&&(document.getElementById("trEANnumber").style.display=""),document.getElementById("trReqnumber")&&(document.getElementById("trReqnumber").style.display=""),document.getElementById("trVatNumber")&&(document.getElementById("trVatNumber").style.display=""),document.getElementById("divContact")&&(document.getElementById("divContact").style.display=""),document.getElementById("divFirstname")&&(document.getElementById("divFirstname").style.display=""),document.getElementById("trLastname")&&(document.getElementById("trLastname").style.display=""),document.getElementById("trTaxExempt")&&(document.getElementById("trTaxExempt").style.display=""),document.getElementById("trTaxExemptRequest")&&(document.getElementById("trTaxExemptRequest").style.display=""),document.getElementById("trTaxExemptApproved")&&(document.getElementById("trTaxExemptApproved").style.display=""),document.getElementById("exCompanyField")&&(document.getElementById("exCompanyField").style.display=""),document.getElementById("exCustomerField")&&(document.getElementById("exCustomerField").style.display="none"),document.getElementById("exCompanyFieldST")&&(document.getElementById("exCompanyFieldST").style.display=""),document.getElementById("exCustomerFieldST")&&(document.getElementById("exCustomerFieldST").style.display="none")):(document.getElementById("trCompanyName")&&(document.getElementById("trCompanyName").style.display="none"),document.getElementById("trEANnumber")&&(document.getElementById("trEANnumber").style.display="none"),document.getElementById("trReqnumber")&&(document.getElementById("trReqnumber").style.display="none"),document.getElementById("trVatNumber")&&(document.getElementById("trVatNumber").style.display="none"),document.getElementById("divContact")&&(document.getElementById("divContact").style.display="none"),document.getElementById("divFirstname")&&(document.getElementById("divFirstname").style.display=""),document.getElementById("trLastname")&&(document.getElementById("trLastname").style.display=""),document.getElementById("trTaxExempt")&&(document.getElementById("trTaxExempt").style.display="none"),document.getElementById("trTaxExemptRequest")&&(document.getElementById("trTaxExemptRequest").style.display="none"),document.getElementById("trTaxExemptApproved")&&(document.getElementById("trTaxExemptApproved").style.display="none"),document.getElementById("exCompanyField")&&(document.getElementById("exCompanyField").style.display="none"),document.getElementById("exCustomerField")&&(document.getElementById("exCustomerField").style.display=""),document.getElementById("exCompanyFieldST")&&(document.getElementById("exCompanyFieldST").style.display="none"),document.getElementById("exCustomerFieldST")&&(document.getElementById("exCustomerFieldST").style.display=""))}function getvatremove(e){document.installform.vattax_rate_id.value=e,document.installform.vatremove.value="1",document.installform.submit()}function validateExtrafield(e){for(var t=e.elements,n="",d=0,l=[],r=0;r<t.length;r++){var a=t[r].type,m=t[r].getAttribute("name"),o=t[r].getAttribute("id"),i=t[r].getAttribute("required"),s=t[r].getAttribute("reqlbl");null==s&&(s=t[r].getAttribute("userfieldlbl")),null==s&&(s=t[r].getAttribute("attribute_name"));var u=t[r].getAttribute("errormsg");null==u&&(u=Joomla.JText._("COM_REDSHOP_IS_REQUIRED"));var c=t[r].value;if(null!=i&&1==i&&null!=s){if("text"!=a&&"textarea"!=a||(""==trim(c)?(n+=s+" : "+u+"\n",t[r].style.borderColor="red",d=1):""!=trim(c)&&(t[r].style.borderColor="")),"select-multiple"==a||"select-one"==a){var y=e.product1.value,g=0;-1==t[r].options.selectedIndex&&(g=1);for(var p=0;p<t[r].options.length;p++)1==t[r].options[p].selected&&0==t[r].options[p].value&&(g=1);if(-1!==o.indexOf("property_id_product1acc_"+y)){var E=o.split("_");if(0<jQuery("input[type='checkbox']#accessory_id_"+E[3]+"_"+E[4]+"product1").length)0===jQuery("input[type='checkbox']#accessory_id_"+E[3]+"_"+E[4]+"product1:checked").length&&(g=0)}if(1==g){for(var v=!1,I=0,_=l.length;I<_;I++)if(l[I]==t[r].getAttribute("name")){v=!0;break}v||(l.push(t[r].getAttribute("name")),n+=s+" : "+u+" \n",t[r].parentNode.style.border="solid 1px red",d=1)}else 0==g&&(t[r].parentNode.style.border="none")}if("radio"==a||"checkbox"==a){var B=t[m],f=0;if(1<B.length)for(var h=0;h<B.length;h++)"null"!=typeof B[h].getAttribute("required")&&1==B[h].getAttribute("required")&&B[h].checked&&(f=1);else t[r].checked&&(f=1);if(0==f)for(var x=0;x<t.length;x++)if(t[r].getAttribute("name")==t[x].getAttribute("name")&&t[x].checked){f=1;break}if(0==f){for(v=!1,I=0,_=l.length;I<_;I++)if(l[I]==t[r].getAttribute("name")){v=!0;break}v||(l.push(t[r].getAttribute("name")),n+=s+" : "+u+" \n",t[r].parentNode.style.border="solid 1px red",d=1)}else 1==f&&(t[r].parentNode.style.border="none")}if("file"==a){var b=document.getElementById(t[r].id).value,T="";document.getElementById("hidden"+t[r].id)&&(T=document.getElementById("hidden"+t[r].id).value),""==b&&""==T?(n+=s+" : "+u+" \n",t[r].style.borderColor="red",d=1):0==d&&(t[r].style.borderColor="")}}}return 1!=d||(alert(n),!1)}jQuery(document).ready(function(){jQuery("#username").blur(function(){if(1==jQuery('input[name="guestuser"]:checked').val()){var e={username:jQuery("#username").val(),user_id:jQuery("input[name=user_id]").val()};e[jQuery("input[name=token]").val()]=1,jQuery.ajax({url:"index.php?option=com_redshop&view=user_detail&task=ajaxValidationUsername",type:"GET",data:e,success:function(e){e=JSON.parse("{"+e.substring(e.indexOf("{")+1)),jQuery("#user_valid").html(e.message),jQuery("#user_valid").css("color","green"),"error"==e.type&&jQuery("#user_valid").css("color","red")},error:function(){}})}}),jQuery(document).on("keydown","input[name*='phone']",function(e){-1!==jQuery.inArray(e.keyCode,[46,8,9,27,13,107,109,110,190])||65===e.keyCode&&(!0===e.ctrlKey||!0===e.metaKey)||35<=e.keyCode&&e.keyCode<=40||(e.shiftKey||e.keyCode<48||57<e.keyCode)&&(e.keyCode<96||105<e.keyCode)&&e.preventDefault()}),jQuery(document).on("keydown","input[name*='phone_ST']",function(e){-1!==jQuery.inArray(e.keyCode,[46,8,9,27,13,107,109,110,190])||65===e.keyCode&&(!0===e.ctrlKey||!0===e.metaKey)||35<=e.keyCode&&e.keyCode<=40||(e.shiftKey||e.keyCode<48||57<e.keyCode)&&(e.keyCode<96||105<e.keyCode)&&e.preventDefault()})});