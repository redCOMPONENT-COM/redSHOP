var ImageScroller=function(n,s){n=P(n),s=P(s);var r,t,f=new Array,l=new Array,o=new Array,_=new Array,u=new Array,h=new Array,c=1,T=1,O=0,w=0,H=0,a=1,e="",I="",p=1,d=1;this.THUMB_HEIGHT=80,this.THUMB_WIDTH=80,this.THUMB_PADDING=4;var m=1,D=0,M=0,y=0,B=!1;function U(){_ElementObj=s,_currentOffset=parseInt(_ElementObj.style.left),_currentOffset<0&&_currentOffset+d<=0?(_ElementObj.style.left=_currentOffset+d+"px",B=!0,t=window.setTimeout(U,p)):_currentOffset<0?(_ElementObj.style.left=_currentOffset+1+"px",B=!0,t=window.setTimeout(U,p)):(B=!1,window.clearTimeout(t))}function g(){_ElementObj=s,_currentOffset=parseInt(_ElementObj.style.left),_currentOffset>M&&_currentOffset-d>=M?(_ElementObj.style.left=_currentOffset-d+"px",B=!0,t=window.setTimeout(g,p)):_currentOffset>M?(_ElementObj.style.left=_currentOffset-1+"px",B=!0,t=window.setTimeout(g,p)):(B=!1,window.clearTimeout(t))}function E(){_ElementObj=s,_currentOffset=parseInt(_ElementObj.style.top),_currentOffset>y&&_currentOffset-d>=y?(_ElementObj.style.top=_currentOffset-d+"px",B=!0,t=window.setTimeout(E,p)):_currentOffset>y?(_ElementObj.style.top=_currentOffset-1+"px",B=!0,t=window.setTimeout(E,p)):(B=!1,m++,window.clearTimeout(t),1==H&&(P(I).innerHTML=_[m-1]),1==w&&(P(e).innerHTML=m+"/"+r))}function b(){_ElementObj=s,_currentOffset=parseInt(_ElementObj.style.top),_currentOffset<D&&_currentOffset+d<=D?(_ElementObj.style.top=_currentOffset+d+"px",B=!0,t=window.setTimeout(b,p)):_currentOffset<D?(_ElementObj.style.top=_currentOffset+1+"px",B=!0,t=window.setTimeout(b,p)):(B=!1,m--,window.clearTimeout(t),1==H&&(P(I).innerHTML=_[m-1]),1==w&&(P(e).innerHTML=m+"/"+r))}function A(){_ElementObj=s,_currentOffset=parseInt(_ElementObj.style.left),_currentOffset<D&&_currentOffset+d<=D?(_ElementObj.style.left=_currentOffset+d+"px",B=!0,t=window.setTimeout(A,p)):_currentOffset<D?(_ElementObj.style.left=_currentOffset+1+"px",B=!0,t=window.setTimeout(A,p)):(B=!1,m--,window.clearTimeout(t),1==H&&(P(I).innerHTML=_[m-1]),1==w&&(P(e).innerHTML=m+"/"+r))}function G(){_ElementObj=s,_currentOffset=parseInt(_ElementObj.style.left),_currentOffset>y&&_currentOffset-d>=y?(_ElementObj.style.left=_currentOffset-d+"px",B=!0,t=window.setTimeout(G,p)):_currentOffset>y?(_ElementObj.style.left=_currentOffset-1+"px",B=!0,t=window.setTimeout(G,p)):(B=!1,m++,window.clearTimeout(t),1==H&&(P(I).innerHTML=_[m-1]),1==w&&(P(e).innerHTML=m+"/"+r))}function x(t,e,n){window.addEventListener?t.addEventListener(e,n,!1):t.attachEvent("on"+e,n)}function P(t){return document.getElementById(t)}this.setNumOfImageToScroll=function(t){a=parseInt(t)},this.enableThumbnailDescription=function(t){H=1,I=t},this.setScrollType=function(t){T=0==t?0:1},this.setScrollSpeed=function(t){p=0<t||t<1e3?t+500:2},this.setScrollAmount=function(t){d=0<t||t<1e3?t:7},this.setClickOpenType=function(t){0!=t&&1!=t||0},this.enableCurrentCount=function(t){w=1,e=t},this.enableThumbBorder=function(t){O=t},this.setThumbsShown=function(t){c=parseInt(t)},this.addThumbnail=function(t,e,n,s,i,r){f[f.length]=t,o[o.length]=e,l[l.length]=n,_[_.length]=s,u[u.length]=i,h[h.length]=r},this.setThumbnailHeight=function(t){this.THUMB_HEIGHT=t},this.getThumbnailHeight=function(){return this.THUMB_HEIGHT},this.setThumbnailWidth=function(t){this.THUMB_WIDTH=t},this.getThumbnailWidth=function(){return this.THUMB_WIDTH},this.setThumbnailPadding=function(t){this.THUMB_PADDING=t},this.getThumbnailPadding=function(){return THUMB_PADDING},this.getCurrentThumbIndex=function(){return m},this.getThumbnailCount=function(){return r},this.renderScroller=function(){var t,e;for((r=f.length)<c&&(c=r),M=0-(r-c)*this.THUMB_WIDTH,0<this.THUMB_PADDING&&(M-=(r+c)*this.THUMB_PADDING),1==O&&(M-=4*r),0==T?(n.style.width=this.THUMB_WIDTH*c+c*(2*this.THUMB_PADDING)+"px",1==O&&(n.style.width=parseInt(n.style.width)+4*c+"px"),n.style.height=this.THUMB_HEIGHT+2*this.THUMB_PADDING+2+"px",1==O&&(n.style.height=parseInt(n.style.height)+4+"px"),s.style.width=this.THUMB_WIDTH*r+r*(2*this.THUMB_PADDING)+"px",/MSIE[\/\s](\d+\.\d+)/.test(navigator.userAgent)&&(s.style.width=this.THUMB_WIDTH*r+this.THUMB_WIDTH+r*(2*this.THUMB_PADDING)+"px"),1==O&&(s.style.width=parseInt(s.style.width)+4*r+"px")):1==T&&(n.style.width=this.THUMB_WIDTH+2*this.THUMB_PADDING+"px",1==O&&(n.style.width=parseInt(n.style.width)+4+"px"),n.style.height=this.THUMB_HEIGHT*c+c*(2*this.THUMB_PADDING)+"px",1==O&&(n.style.height=parseInt(n.style.height)+4*c+"px"),s.style.width=this.THUMB_WIDTH+2*this.THUMB_PADDING+"px",1==O&&(s.style.width=parseInt(s.style.width)+4+"px")),t=document.createElement("a"),e=document.createElement("img"),i=0;i<r;i++){(t=document.createElement("a")).href=o[i],t.title=l[i],/Firefox[\/\s](\d+\.\d+)/.test(navigator.userAgent)&&(t.style.margin="4.5px"),/MSIE[\/\s](\d+\.\d+)/.test(navigator.userAgent)&&(t.style.margin="0px");document.all&&0,(e=document.createElement("img")).src=f[i],e.alt=l[i],e.border=1,e.id=u[i],e.width=this.THUMB_WIDTH,e.height=this.THUMB_HEIGHT,e.style.border=h[i],e.style.padding=this.THUMB_PADDING,t.appendChild(e),s.appendChild(t)}1==w&&x(window,"load",this.updateCurrentCount),1==H&&x(window,"load",this.updateCurrentDescription)},this.stopSmoothScroll=function(){B=!1,window.clearTimeout(t)},this.smoothScrollForward=function(){_origOffset=parseInt(s.style.left),_currentOffset=parseInt(s.style.left),_newOffset=_currentOffset-d,0<this.THUMB_PADDING&&(_newOffset-=2*a*this.THUMB_PADDING),1==O&&(_newOffset-=4),0==B&&_newOffset>=M&&(y=_newOffset,g())},this.stopSmoothScroll=function(){B=!1,window.clearTimeout(t)},this.scrollUp=function(){_origOffset=parseInt(s.style.top),_currentOffset=parseInt(s.style.top),_newOffset=_currentOffset-this.THUMB_HEIGHT*a,0<this.THUMB_PADDING&&(_newOffset-=2*this.THUMB_PADDING),1==O&&(_newOffset-=4),0==B&&_newOffset>=M&&(y=_newOffset,E())},this.scrollDown=function(){_origOffset=parseInt(s.style.top),_currentOffset=parseInt(s.style.top),_newOffset=_currentOffset+this.THUMB_HEIGHT*a,0<this.THUMB_PADDING&&(_newOffset+=2*this.THUMB_PADDING),1==O&&(_newOffset+=4),_newOffset<=0&&_currentOffset>_origOffset-this.THUMB_HEIGHT&&0==B&&_newOffset>=M&&(D=_newOffset,b())},this.scrollTop=function(){0==B&&(y=-1*(r-c)*this.THUMB_HEIGHT,m=r-c,E())},this.scrollBottom=function(){0==B&&(D=0,m=r-c,b())},this.scrollImageCenter=function(t){_origOffset=parseInt(s.style.left),0==t&&(D=0,m=t+1,A());var e=-_origOffset;if(0<t){var n=(t-parseInt(c/2))*(this.THUMB_WIDTH+2*a*this.THUMB_PADDING);n<e?0<e&&(D=-n,m=t+1,A()):n<-M&&(y=-n,m=t+1,G())}},this.smoothScrollReverse=function(){_origOffset=parseInt(s.style.left),_currentOffset=parseInt(s.style.left),_newOffset=_currentOffset+d,0<this.THUMB_PADDING&&(_newOffset+=this.THUMB_PADDING*(2*a)),1==O&&(_newOffset+=4),_newOffset<=0&&_currentOffset>_origOffset-this.THUMB_WIDTH*a&&0==B&&(D=_newOffset,U())},this.scrollReverse=function(){_origOffset=parseInt(s.style.left),_currentOffset=parseInt(s.style.left),_newOffset=_currentOffset+this.THUMB_WIDTH*a,0<this.THUMB_PADDING&&(_newOffset+=this.THUMB_PADDING*(2*a)),1==O&&(_newOffset+=4),_newOffset<=0&&_currentOffset>_origOffset-this.THUMB_WIDTH*a&&0==B&&(D=_newOffset,A())},this.scrollForward=function(){_origOffset=parseInt(s.style.left),_currentOffset=parseInt(s.style.left),_newOffset=_currentOffset-this.THUMB_WIDTH*a,0<this.THUMB_PADDING&&(_newOffset-=2*a*this.THUMB_PADDING),1==O&&(_newOffset-=4),0==B&&_newOffset>=M&&(y=_newOffset,G())},this.scrollEnd=function(){0==B&&(y=M,m=r-c,G())},this.scrollBegin=function(){0==B&&(D=0,m=2,A())},this.updateCurrentDescription=function(){P(I).innerHTML=_[m-1]},this.updateCurrentCount=function(){P(e).innerHTML=m+"/"+r}};