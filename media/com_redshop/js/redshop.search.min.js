"undefined"==typeof bsn&&(_b=bsn={}),void 0===_b.Autosuggest?_b.Autosuggest={}:alert("Autosuggest is already set!"),_b.AutoSuggest=function(t,e){if(!document.getElementById)return 0;if(this.fld=_b.DOM.gE(t),!this.fld)return 0;this.sInp="",this.nInpC=0,this.aSug=[],this.iHigh=0,this.oP=e||{};var s,i={minchars:1,meth:"get",varname:"input",className:"autosuggest",timeout:2500,delay:500,offsety:-5,shownoresults:!0,noresults:"No results!",maxheight:250,cache:!0,maxentries:25,getrawresults:!1};for(s in i)typeof this.oP[s]!=typeof i[s]&&(this.oP[s]=i[s]);var n=this;this.fld.onkeypress=function(t){return n.onKeyPress(t)},this.fld.onkeyup=function(t){return n.onKeyUp(t)},this.fld.setAttribute("autocomplete","off")},_b.AutoSuggest.prototype.onKeyPress=function(t){var e=1;switch(window.event?window.event.keyCode:t.keyCode){case 13:this.setHighlightedValue(),e=0;break;case 27:this.clearSuggestions()}return e},_b.AutoSuggest.prototype.onKeyUp=function(t){var e=window.event?window.event.keyCode:t.keyCode,s=1;switch(e){case 38:case 40:this.changeHighlight(e),s=0;break;default:this.getSuggestions(this.fld.value)}return s},_b.AutoSuggest.prototype.getSuggestions=function(t){if(t==this.sInp)return 0;if(_b.DOM.remE(this.idAs),(this.sInp=t).length<this.oP.minchars)return this.aSug=[],this.nInpC=t.length,0;var e=this.nInpC;this.nInpC=t.length?t.length:0;var s=this.aSug.length;if(this.nInpC>e&&s&&s<this.oP.maxentries&&this.oP.cache){for(var i=[],n=0;n<s;n++)this.aSug[n].value.substr(0,t.length).toLowerCase()!=t.toLowerCase()&&this.aSug[n].value_number.substr(0,t.length).toLowerCase()!=t.toLowerCase()||i.push(this.aSug[n]);return this.aSug=i,this.createList(this.aSug),!1}var a=this,r=this.sInp;return clearTimeout(this.ajID),this.ajID=setTimeout(function(){a.doAjaxRequest(r)},this.oP.delay),!1},_b.AutoSuggest.prototype.doAjaxRequest=function(e){if(e!=this.fld.value)return!1;var s=this;if("function"==typeof this.oP.script)var t=this.oP.script(encodeURIComponent(this.sInp));else t=this.oP.script+this.oP.varname+"="+encodeURIComponent(this.sInp);if(!t)return!1;var i=this.oP.meth;e=this.sInp;(new _b.Ajax).makeRequest(t,i,function(t){s.setSuggestions(t,e)},function(t){})},_b.AutoSuggest.prototype.setSuggestions=function(req,input){if(input!=this.fld.value)return!1;if(this.aSug=[],this.oP.json)for(var jsondata=eval("("+req.responseText+")"),i=0;i<jsondata.results.length;i++)if(this.oP.getrawresults)this.aSug.push(jsondata.results[i]);else{var val=jsondata.results[i].value;if(jsondata.results[i].value_number)var val=jsondata.results[i].value+"("+jsondata.results[i].value_number+")";jsondata.results[i].volume?this.aSug.push({id:jsondata.results[i].id,value:val,volume:jsondata.results[i].volume,value_number:jsondata.results[i].value_number,product_image:jsondata.results[i].product_image,product_price:jsondata.results[i].product_price}):jsondata.results[i].price?this.aSug.push({id:jsondata.results[i].id,value:val,price:jsondata.results[i].price,value_number:jsondata.results[i].value_number,product_image:jsondata.results[i].product_image,product_price:jsondata.results[i].product_price}):jsondata.results[i].value_number?this.aSug.push({id:jsondata.results[i].id,value:val,value_number:jsondata.results[i].value_number,product_image:jsondata.results[i].product_image,product_price:jsondata.results[i].product_price}):this.aSug.push({id:jsondata.results[i].id,value:val,link:jsondata.results[i].link,product_image:jsondata.results[i].product_image,product_price:jsondata.results[i].product_price})}else for(var xml=req.responseXML,results=xml.getElementsByTagName("results")[0].childNodes,i=0;i<results.length;i++)results[i].hasChildNodes()&&this.aSug.push({id:results[i].getAttribute("id"),value:results[i].childNodes[0].nodeValue});this.idAs="as_"+this.fld.id,this.createList(this.aSug)},_b.AutoSuggest.prototype.createList=function(t){var e=this;if(_b.DOM.remE(this.idAs),this.killTimeout(),0==t.length&&!this.oP.shownoresults)return!1;var s=_b.DOM.cE("div",{id:this.idAs,className:this.oP.className}),i=_b.DOM.cE("div",{className:"as_corner"}),n=_b.DOM.cE("div",{className:"as_bar"}),a=_b.DOM.cE("div",{className:"as_header"});a.appendChild(i),a.appendChild(n),s.appendChild(a);for(var r=_b.DOM.cE("ul",{id:"as_ul"}),o=0;o<t.length;o++){var u=t[o].value,h=u.toLowerCase().indexOf(this.sInp.toLowerCase()),l=u.substring(0,h)+"<em>"+u.substring(h,h+this.sInp.length)+"</em>"+u.substring(h+this.sInp.length),d=_b.DOM.cE("span",{},l,!0);if(""!=t[o].info){var c=_b.DOM.cE("br",{});d.appendChild(c);var p=_b.DOM.cE("small",{},t[o].info);d.appendChild(p)}var g=_b.DOM.cE("a",{href:"#"}),f=_b.DOM.cE("span",{className:"tl"}," "),m=_b.DOM.cE("span",{className:"tr"}," ");g.appendChild(f),g.appendChild(m);var v=document.createElement("div");v.className+="search-ajax-image",v.innerHTML=t[o].product_image;var _=document.createElement("div");_.className+="search-ajax-price",_.innerHTML=t[o].product_price,g.appendChild(v),g.appendChild(d),g.appendChild(_),g.name=o+1,g.onclick=function(){return e.setHighlightedValue(),!1},g.onmouseover=function(){e.setHighlight(this.name)};var b=_b.DOM.cE("li",{},g);r.appendChild(b)}if(0==t.length&&this.oP.shownoresults){b=_b.DOM.cE("li",{className:"as_warning"},this.oP.noresults);r.appendChild(b)}s.appendChild(r);var y=_b.DOM.cE("div",{className:"as_corner"}),C=_b.DOM.cE("div",{className:"as_bar"}),S=_b.DOM.cE("div",{className:"as_footer"});S.appendChild(y),S.appendChild(C),s.appendChild(S);var j=_b.DOM.getPos(this.fld);s.style.left=j.x+"px",s.style.top=j.y+this.fld.offsetHeight+this.oP.offsety+"px",s.style.width=this.fld.offsetWidth+"px",s.onmouseover=function(){e.killTimeout()},s.onmouseout=function(){e.resetTimeout()},document.getElementsByTagName("body")[0].appendChild(s),this.iHigh=0;e=this;this.toID=setTimeout(function(){e.clearSuggestions()},this.oP.timeout+5e3)},_b.AutoSuggest.prototype.changeHighlight=function(t){var e,s=_b.DOM.gE("as_ul");if(!s)return!1;40==t?e=this.iHigh+1:38==t&&(e=this.iHigh-1),e>s.childNodes.length&&(e=s.childNodes.length),e<1&&(e=1),this.setHighlight(e)},_b.AutoSuggest.prototype.setHighlight=function(t){var e=_b.DOM.gE("as_ul");if(!e)return!1;0<this.iHigh&&this.clearHighlight(),this.iHigh=Number(t),e.childNodes[this.iHigh-1].className="as_highlight",this.killTimeout()},_b.AutoSuggest.prototype.clearHighlight=function(){var t=_b.DOM.gE("as_ul");if(!t)return!1;0<this.iHigh&&(t.childNodes[this.iHigh-1].className="",this.iHigh=0)},_b.AutoSuggest.prototype.setHighlightedValue=function(){this.iHigh&&(this.sInp=this.fld.value=this.aSug[this.iHigh-1].value,this.fld.focus(),this.fld.selectionStart&&this.fld.setSelectionRange(this.sInp.length,this.sInp.length),this.clearSuggestions(),"function"==typeof this.oP.callback&&this.oP.callback(this.aSug[this.iHigh-1]))},_b.AutoSuggest.prototype.killTimeout=function(){clearTimeout(this.toID)},_b.AutoSuggest.prototype.resetTimeout=function(){clearTimeout(this.toID);var t=this;this.toID=setTimeout(function(){t.clearSuggestions()},1e3)},_b.AutoSuggest.prototype.clearSuggestions=function(){this.killTimeout();var t=_b.DOM.gE(this.idAs),e=this;if(t)new _b.Fader(t,1,0,250,function(){_b.DOM.remE(e.idAs)})},void 0===_b.Ajax&&(_b.Ajax={}),_b.Ajax=function(){this.req={},this.isIE=!1},_b.Ajax.prototype.makeRequest=function(t,e,s,i){"POST"!=e&&(e="GET"),this.onComplete=s,this.onError=i;var n=this;window.XMLHttpRequest?(this.req=new XMLHttpRequest,this.req.onreadystatechange=function(){n.processReqChange()},this.req.open("GET",t,!0),this.req.setRequestHeader("X-Requested-With","XMLHttpRequest"),this.req.send(null)):window.ActiveXObject&&(this.req=new ActiveXObject("Microsoft.XMLHTTP"),this.req&&(this.req.onreadystatechange=function(){n.processReqChange()},this.req.open(e,t,!0),this.req.setRequestHeader("X-Requested-With","XMLHttpRequest"),this.req.send()))},_b.Ajax.prototype.processReqChange=function(){4==this.req.readyState&&(200==this.req.status?this.onComplete(this.req):this.onError(this.req.status))},void 0===_b.DOM&&(_b.DOM={}),_b.DOM.cE=function(t,e,s,i){var n=document.createElement(t);if(!n)return 0;for(var a in e)n[a]=e[a];var r=typeof s;return"string"!=r||i?"string"==r&&i?n.innerHTML=s:"object"==r&&n.appendChild(s):n.appendChild(document.createTextNode(s)),n},_b.DOM.gE=function(t){var e=typeof t;if("undefined"==e)return 0;if("string"!=e)return void 0!==t.appendChild?t:0;var s=document.getElementById(t);return s&&void 0!==s.appendChild?s:0},_b.DOM.remE=function(t){var e=this.gE(t);return e&&!!e.parentNode.removeChild(e)||0},_b.DOM.getPos=function(t){var e=0;if((s=t=this.gE(t)).offsetParent)for(;s.offsetParent;)e+=s.offsetLeft,s=s.offsetParent;else s.x&&(e+=s.x);var s,i=0;if((s=t).offsetParent)for(;s.offsetParent;)i+=s.offsetTop,s=s.offsetParent;else s.y&&(i+=s.y);return{x:e,y:i}},void 0===_b.Fader&&(_b.Fader={}),_b.Fader=function(t,e,s,i,n){if(!t)return 0;this.e=t,this.from=e,this.to=s,this.cb=n,this.nDur=i,this.nInt=50,this.nTime=0;var a=this;this.nID=setInterval(function(){a._fade()},this.nInt)},_b.Fader.prototype._fade=function(){this.nTime+=this.nInt;var e=Math.round(100*this._tween(this.nTime,this.from,this.to,this.nDur)),t=e/100;if(this.e.filters)try{this.e.filters.item("DXImageTransform.Microsoft.Alpha").opacity=e}catch(t){this.e.style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity="+e+")"}else this.e.style.opacity=t;this.nTime==this.nDur&&(clearInterval(this.nID),null!=this.cb&&this.cb())},_b.Fader.prototype._tween=function(t,e,s,i){return e+t/i*(s-e)};